title: 浏览器输入url后发生了什么
keywords: 浏览器输入url后发生了什么
description: 浏览器输入url后发生了什么
tags: web
toc: true
date: 2017-02-21 19:20:35
---
日常生活中，我们经常使用浏览器浏览网页，在地址栏输入一个网址，然后敲回车，接着一个网页就呈现在浏览器中了，那么从输入页面地址到我们看到页面，这中间都发生了什么呢？接下来我们就一起去分析一下。

<!--more-->

##### 输入一个网址
在浏览器地址栏中输入一个网址 xuerlove.com

##### 缓存判断
浏览器会去浏览器缓存文件中查找对应网址的缓存文件，如果找到了缓存的文件，查看缓存文件的响应头信息，根据Last-Modified时间，Expires时间或者Cache-Control max-age的时间去判断缓存是否过期，如果没有过期则返回一个 200 frome cache 的状态码，然后使用缓存的文件，接下来浏览器加载，解析，渲染等等。
如果缓存过期了，或者根本就没有缓存，这时候就往下执行。

##### ip查找
获取域名所对应的ip地址
* 浏览器缓存
* 本地缓存
* 路由器缓存
* DNS服务器查找
经过这么多步骤，最终会获取到服务器的ip地址，我们要请求的服务就在那台机器上面。

##### 发送Http请求
接着浏览器向服务器发送一个http请求，带着请求头和请求体
如果是http请求，客户端和服务端经过三次握手，第一次客户端向服务端发送一个包，第二次服务端收到包后响应已经收到包，并且发送给客户端一个包，第三次客户端接收到确认消息并且收到服务器发来的包，向服务器再发送一个确认包，发完后，客户端和服务器进入连接状态，完成了三次握手。
如果是https请求，

##### 永久重定向
服务器返回301永久重定向地址 xuerlove.com 到 www.xuerlove.com，这一步是为了seo友好而做的，服务器可以判断为一级域名，给补全www,是为了让搜索引擎统计访问量的时候，都统计到一个地址上，有利于排名。

##### 跟踪重定向地址
客户端继续向www.xuerlove.com发送一个同样的http请求

##### 服务器处理请求
如果是动态页面，服务器会通过计算，生成最后要返回的文件。
服务器接收到请求后根据请求头中的If-None-Match,If-Modified-Since去判断要返回的文件是否变更过，如果没有变更，则向浏览器返回304 not modify,浏览器接收到响应后会继续使用缓存的文件，然后更新Last-Modify时间，接下来浏览器加载，解析，渲染等等。

##### 服务器返回请求结果
如果服务器的文件是最新的，服务器向浏览器返回页面结果

##### 浏览器渲染Html
浏览器加载页面，渲染DOM树

##### 请求页面资源
渲染的过程中遇到资源标签，会去请求各种资源，下载下来css后，会去生成CSSOM树，然后布局以及绘制。下载完js后会在domReady后会去执行js，脚本可能会动态处理页面。

##### 发送交互请求
js脚本中可能发起一些异步请求，然后去完成对页面的一些渲染。

##### 页面加载完成
一个完整的页面就处理完呈现出来了