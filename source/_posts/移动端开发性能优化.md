title: 移动端开发性能优化
keywords: 移动端开发性能优化,性能优化
description: 移动端开发性能优化
date: 2016-04-14 10:43:35
tags: web
toc: true
---
##### 介绍
移动端这几年可以说发展的特别快，并且以绝对的优势超过了pc端，所以移动端的应用也越来越多，越来越重要。移动端不同于pc端，从设备的性能，网络差异，屏幕大小都有很大的差异，所以移动端的性能要尤为注意，力争我们的网站在移动端性能达到最佳。

<!--more-->

##### 代码
从代码层面讲，务必做到精简，高效。移动端平台分ios android windows phone等，每个平台又有很多手机生产商，每种手机的性能又差异很大，还有些厂商还会自己定制浏览器内核，等等因素吧，导致了移动端经常出现各种差异性的表现，常常顾此失彼。那么就要求我们写的代码效率高一些，逻辑精简些，从程序层面减少因性能带来的问题，这是最好的方法去避免出现一些奇葩问题。还要做好一系列的异常处理措施，不要让代码出现报错的情况。减少dom操作，增加数据缓存机制，离线数据处理等，另外代码的精简也可以让页面下载资源的时间减少。

##### 框架
最近在开发过程中，使用了reactjs这个框架，不得不说这个框架应用起来还是比较顺利的，从开发到最终的页面表现来说，都是比较满意的。但是有一个问题是，在生成的代码中会生成过多的dom节点，这一点需要注意一下。因为在hybrid中，dom元素过多可能会影响页面性能，甚至导致app崩溃。

##### 组件
应用第三方组件，要慎重考虑，这里就拿iscroll来说，这个组建无疑优化了滑动的体验，但是它是非常耗性能的，还有就是安卓手机上的表现并不理想，在一些滚动监听上也存在问题。

##### 布局与css
合理的布局能够有效的减少显示上的bug，常见的就是fixed的问题，以及input框和软键盘的问题。

##### 硬件加速
硬件加速是一件好事，但是它的弊端也显露无疑，电池耗电快，手机发热等等

##### 优化点
* 合并域名，减少dns解析的时间
* 请求数量尽量少，相应的数据尽量精简
* 请求尽量并发，不要串行
* 静态资源使用单独的域名，做到cookie free，有条件的话使用cdn
* 合并小图标，使用雪碧图，使用font代替图标
* 去掉没用cookie，cookie命名尽量简短，cookie值尽量精简
* 完善本地缓存数据（优先展示出缓存数据，数据返回后再更新）
* 注意jsonp的请求，jsonp会阻塞页面加载，阻塞页面操作，做好超时异常判断
* 压缩html中的空格换行，使用gzip压缩
* css规则不要太复杂，去掉没用的css，css放在head中，js放在body底部
* 尽量使用原生方法
* 减少dom操作，尽量缓存dom
* touch端应该考虑使用离线存储(cache manifest)
* hybrid尽量使用离线包机制
* 对于过长的页面，应该考虑优先加载精简页面(短页面)，点击底部加载更多按钮，根据当前gps,network记录当前网络情况(页面其余部分加载时间小于一定范围即可以认定网络好)，下次在一定范围内打开页面默认加载全的页面，否则展示精简页面，对一些低版本的系统，可以让它永远展示精简页面，查看全部才能看到全部内容，这样能够保证用户看到页面的速度
* 页面内容按需加载，模块可以使用滚动加载，图片使用懒加载
* 页面渲染尽量不要依赖接口数据返回，接口的不稳定性可能会拖累页面加载时间

