<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[黑卓]]></title>
  <subtitle><![CDATA[Encode my life]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://www.xuerlove.com/"/>
  <updated>2017-02-17T03:13:09.000Z</updated>
  <id>http://www.xuerlove.com/</id>
  
  <author>
    <name><![CDATA[黑卓]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[网站性能监控showslow]]></title>
    <link href="http://www.xuerlove.com/2017/02/09/%E7%BD%91%E7%AB%99%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7showslow/"/>
    <id>http://www.xuerlove.com/2017/02/09/网站性能监控showslow/</id>
    <published>2017-02-09T06:33:53.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<p>今天，性能是一个我们常谈的话题，网站性能的重要性不言而喻。<br><a href="https://github.com/sergeychernyshev/showslow/wiki" target="_blank" rel="external">showslow</a>是一个github上开源的，能够帮助我们监控网站性能的工具。我们可以使用yslow和pagespeed等工具生成分析结果并以图表的方式展现出来。从而全面了解我们网站有哪些方面需要改进。</p>
<a id="more"></a>
<h4 id="环境">环境</h4><ul>
<li>安装PHP环境</li>
<li>安装apache服务器</li>
<li>安装mysql数据库</li>
</ul>
<h4 id="phantomjs">phantomjs</h4><p><a href="http://phantomjs.org/download.html" target="_blank" rel="external">安装phantomjs</a></p>
<h4 id="yslowjs">yslowjs</h4><p><a href="http://yslow.org/phantomjs/" target="_blank" rel="external">yslowjs</a><br>通过yslow分析页面，上报到showslow<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#phantomjs yslow.js http://www.test.com/ --info grade  -b http://127.0.0.1:8088/php/webapp/beacon/yslow/</span></div></pre></td></tr></table></figure></p>
<h4 id="phantomas">phantomas</h4><p>使用phantomas可以收集网络性能指标<br>安装: npm install –global phantomas<br>通过phantomas生成har<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phantomas http://www.test.com/ --engine webkit --har <span class="built_in">test</span></div></pre></td></tr></table></figure></p>
<p>读取har文件内容，通过接口 <a href="http://127.0.0.1:8088/php/webapp/beacon/har/?url=http://www.test.com/" target="_blank" rel="external">http://127.0.0.1:8088/php/webapp/beacon/har/?url=http://www.test.com/</a> 上传到showslow平台</p>
<h4 id="pagespeed">pagespeed</h4><p><a href="https://code.google.com/apis/console/#access" target="_blank" rel="external">申请apiKey</a><br>通过pagespeed分析页面，上报到showslow<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl http://127.0.0.1:8088/php/webapp/beacon/pagespeed/?api\&amp;u=http://www.test.com/</div></pre></td></tr></table></figure></p>
<h4 id="HARViewer安装">HARViewer安装</h4><p><a href="https://github.com/janodvarko/harviewer/archive/master.zip" target="_blank" rel="external">HARViewer</a>能够帮助我们</p>
<ul>
<li><a href="https://github.com/janodvarko/harviewer/archive/master.zip" target="_blank" rel="external">下载HARViewer</a></li>
<li>把解压的文件copy到showslow webapp目录下即可</li>
</ul>
<h4 id="showslow安装">showslow安装</h4><ul>
<li><a href="https://github.com/sergeychernyshev/showslow/releases" target="_blank" rel="external">下载showslow</a></li>
<li>把解压文件夹放到apache www目录下即可</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#unzip showslow</span></div><div class="line"><span class="comment">#cd showslow</span></div><div class="line"><span class="comment">#cp config.sample.php config.php</span></div><div class="line"><span class="comment">#vim config.php</span></div><div class="line"></div><div class="line">// 配置数据库</div><div class="line"><span class="variable">$db</span> = <span class="string">'showslow'</span>;</div><div class="line"><span class="variable">$user</span> = <span class="string">'xxx'</span>;</div><div class="line"><span class="variable">$pass</span> = <span class="string">'xxx'</span>;</div><div class="line"><span class="variable">$host</span> = <span class="string">'localhost'</span>;</div><div class="line"><span class="variable">$port</span> = 3306;</div><div class="line"></div><div class="line">// pagespeed测试key</div><div class="line"><span class="variable">$pageSpeedOnlineAPIKey</span> = <span class="string">'xxx'</span>;</div><div class="line"></div><div class="line">// 配置har存储</div><div class="line"><span class="variable">$enableHARBeacon</span> = <span class="literal">true</span>;</div><div class="line"></div><div class="line">// 配置harview目录</div><div class="line"><span class="variable">$HARViewerBase</span> = <span class="string">'/php/webapp/harviewer/webapp'</span>;</div><div class="line"></div><div class="line"><span class="comment">#vim global.php</span></div><div class="line"></div><div class="line">// 在页面中配置需要监控测试的页面</div><div class="line"><span class="variable">$enableMyURLs</span> = <span class="literal">true</span>;</div><div class="line"></div><div class="line"><span class="comment">#make</span></div></pre></td></tr></table></figure>
<p>这样我们就能在页面添加要监控的网站了</p>
<h4 id="使用">使用</h4><p>可以编写脚本，每天定时去执行检测，获取所有监控的url，然后分别去执行上述的那些方法，进行检测和上报的showslow</p>
]]></content>
    <summary type="html">
    <![CDATA[网站性能监控showslow]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[实现发送邮件功能]]></title>
    <link href="http://www.xuerlove.com/2017/02/09/%E5%AE%9E%E7%8E%B0%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6%E5%8A%9F%E8%83%BD/"/>
    <id>http://www.xuerlove.com/2017/02/09/实现发送邮件功能/</id>
    <published>2017-02-09T03:00:12.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<p>日常开发中，我们经常会有发送邮件的需求，无论是发送代码中的异常或者错误信息，还是发送一些网站数据，下面我们就动手去实现一下这个功能。</p>
<a id="more"></a>
<h5 id="nodejs">nodejs</h5><p>以发送163邮箱为例，使用nodemailer模块，这里用的版本是0.7.1，最新版本的参数稍有变更，请自行<a href="https://github.com/nodemailer/nodemailer" target="_blank" rel="external">前往</a>查看<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// "nodemailer": "0.7.1"</span></div><div class="line"><span class="keyword">import</span> nodemailer <span class="keyword">from</span> <span class="string">'nodemailer'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> smtpTransport = nodemailer.createTransport(<span class="string">"SMTP"</span>, &#123;</div><div class="line">  <span class="attr">host</span>: <span class="string">"smtp.163.com"</span>,</div><div class="line">  <span class="attr">secureConnection</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">port</span>: <span class="number">465</span>,</div><div class="line">  <span class="attr">auth</span>: &#123;</div><div class="line">    <span class="attr">user</span>: <span class="string">"test@163.com"</span>,</div><div class="line">    <span class="attr">pass</span>: <span class="string">"test"</span> <span class="comment">// 使用客户端授权密码，在邮件设置中可以获取到</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">let</span> mailOptionsDefault = &#123;</div><div class="line">  <span class="attr">from</span>: <span class="string">"test &lt;test@163.com&gt;"</span>,</div><div class="line">  <span class="attr">to</span>: <span class="string">"test@test.com"</span>,</div><div class="line">  <span class="attr">subject</span>: <span class="string">"test"</span>,</div><div class="line">  <span class="attr">text</span>: <span class="string">"test"</span>,</div><div class="line">  <span class="attr">html</span>: <span class="string">"test"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendEmail</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  smtpTransport.sendMail(mailOptionsDefault, (error, response) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span>(error)&#123;</div><div class="line">      <span class="built_in">console</span>.log(error);</div><div class="line">    &#125; <span class="keyword">else</span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">"Message sent: "</span> + response.message);</div><div class="line">    &#125;</div><div class="line">    smtpTransport.close();</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123;</div><div class="line">  sendEmail</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h5 id="python">python</h5><p>以发送163邮箱为例<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> smtplib </div><div class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendMail</span><span class="params">(text)</span>:</span></div><div class="line">    sender = <span class="string">'test@163.com'</span>  </div><div class="line">    receiver = [<span class="string">'test@163.com'</span>]</div><div class="line">    mailToCc = []</div><div class="line">    subject = <span class="string">'[test]'</span>  </div><div class="line">    smtpserver = <span class="string">'smtp.163.com'</span>  </div><div class="line">    username = <span class="string">'test@163.com'</span>  </div><div class="line">    password = <span class="string">'test'</span>  // 使用客户端授权密码，在邮件设置中可以获取到</div><div class="line">    </div><div class="line">    msg = MIMEText(text, <span class="string">'html'</span>, <span class="string">'utf-8'</span>)      </div><div class="line">    msg[<span class="string">'Subject'</span>] = subject  </div><div class="line">    msg[<span class="string">'From'</span>] = sender</div><div class="line">    msg[<span class="string">'To'</span>] = <span class="string">';'</span>.join(receiver)</div><div class="line">    msg[<span class="string">'Cc'</span>] = <span class="string">';'</span>.join(mailToCc)</div><div class="line">    smtp = smtplib.SMTP_SSL(<span class="string">'smtp.163.com'</span>, <span class="number">465</span>)  </div><div class="line">    smtp.connect(smtpserver)  </div><div class="line">    smtp.login(username, password)  </div><div class="line">    smtp.sendmail(sender, receiver + mailToCc, msg.as_string())  </div><div class="line">    smtp.quit() </div><div class="line"></div><div class="line">sendMail(<span class="string">'test'</span>)</div></pre></td></tr></table></figure></p>
<h5 id="html">html</h5><p>简单的打开邮箱客户端，自动填充收件人<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"Mailto:wuzhuo0425@163.com"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>稍微复杂一些的，内容更丰富的发送方式<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"Mailto:wuzhuo0425@163.com?CC=test@163.com&amp;BCC=test@163.com&amp;Subject=Hello&amp;Body=world"</span>&gt;</span>email<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[代码实现发送邮件功能]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[前端笔试题集]]></title>
    <link href="http://www.xuerlove.com/2017/02/07/%E5%89%8D%E7%AB%AF%E7%AC%94%E8%AF%95%E9%A2%98%E9%9B%86/"/>
    <id>http://www.xuerlove.com/2017/02/07/前端笔试题集/</id>
    <published>2017-02-07T08:25:43.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="笔试题集">笔试题集</h4><h5 id="viewport禁止页面放大">viewport禁止页面放大</h5><p>通过设置页面meta标签viewport的值，可以设置页面的宽高度以及缩放行为</p>
<ul>
<li>initial-scale  设置页面初始缩放比例<br>＊ minimum-scale 设置缩放最小比例<br>＊ maximum-scale 设置缩放最大比例<br>＊ user-scalable 设置用户是否可以用手控制缩放<br>通过设置 initial-scale=1 user-scalable=no 或者 initial-scale=1 maximum-scale=1 禁止用户放大或者缩小网页。</li>
</ul>
<a id="more"></a>
<h5 id="data-*_属性的作用">data-* 属性的作用</h5><p>使用 data-<em> 可以嵌入自定义数据，可以存储页面或者应用程序的私有自定义数据，使得html元素可以嵌入数据。可以通过javascript设置和获取data-</em>的数据。data-*的属性必须以data开头，不能包含大写字母的任意字符串。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">data-val</span>=<span class="string">"ddd"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> test = <span class="built_in">document</span>.getElementById(<span class="string">'test'</span>);</div><div class="line"><span class="built_in">console</span>.log(test.dataset.val);</div><div class="line">test.dataset.val = <span class="string">'eee'</span>;</div><div class="line"><span class="built_in">console</span>.log(test.dataset.val);</div></pre></td></tr></table></figure>
<h5 id="cookie_sessionStorage_localStorage">cookie sessionStorage localStorage</h5><ul>
<li>cookie:<br>存储在浏览器中，有域名和path的限制，在所有同源窗口中共享，可以设置过期时间，默认是浏览器关闭失效，存储大小最大4k，cookie的值会随每次http的请求进行传输，所以cookie应该尽量少而且精简，不至于影响网页性能，通常用来存储一些用户登录信息等，应该做好加密工作，不要存储一些太过机密的数据。原生接口不太友好，二次封装后用起来更方便。</li>
<li>localStorage<br>存储在浏览器中，有域名限制，在所有同源窗口中共享，不能设置过期时间(可以自己通过数据去控制),永久有效，存储大小最大5M, 值不会随http传输携带，可以存储一些本地数据，在性能优化，数据缓存上都可以使用，不要存储机密数据，防止隐私泄漏，xss攻击等。原生接口支持的比较好，但是可以封装让其对对象数组支持的更好。<br>老版本ie浏览器不支持改属性，可以使用store.js，通过userData进行兼容处理过了。</li>
<li>sessionStorage<br>存储在浏览器中，有域名和窗口的限制，不同浏览器窗口同源也不共享，不可以设置过期时间，仅在当前会话下有效，关闭页面或者关闭浏览器都会被清除，存储大小最大5M，可以存储一些页面的临时数据，或者页面运行期间的一些流程控制，值不会随http传输携带，不要存储机密数据，防止隐私泄漏，xss攻击等。原生接口支持的比较好，但是可以封装让其对对象数组支持的更好。</li>
</ul>
<h5 id="浏览器的标准模式，怪异模式">浏览器的标准模式，怪异模式</h5><p>HTML和CSS标准完成之前，各个浏览器对HTML和CSS的解析有各自不同的实现，很多旧的网页是按照非标准去设计实现的，在标准形成之后，为了向后兼容，所以现代浏览器都会有两种渲染模式，标准模式和怪异模式。具体使用哪种渲染模式，通过DOCTYPE去区分，当浏览器遇到正确的DOCTYPE的时候，就用标准模式渲染，遇到错误的DOCTYPE或者没有DOCTYPE声明的，则使用怪异模式渲染。</p>
<ul>
<li>盒模型差异<br>标准模式下CSS盒模型宽高不包含内边距和边框<br>怪异模式下CSS盒模型宽高包含内边距和边框<br>＊ 行内元素垂直对齐<br>标准模式下将会对齐到盒内文本的基线，怪异模式下对齐到底部。</li>
</ul>
<h5 id="盒模型宽高|box-sizing">盒模型宽高|box-sizing</h5><ul>
<li>标准模式下<br>盒子总宽度 = width + padding + border + margin</li>
<li>怪异模式下<br>内容宽度包含 content + padding + border<br>盒子总宽度 = width + margin</li>
<li>box-sizing<br>content-box : 采用标准模式解析计算(默认值)<br>border-box : 采用怪异模式解析计算</li>
</ul>
<h5 id="函数中arguments">函数中arguments</h5><p>arguments是一个对象，该对象的属性值是从0-n的数字，所以访问的时候可以像数组那样访问，但它却不是数组，它还拥有length属性，返回的是属性的长度，callee属性返回的是正在被执行的function,可以在递归调用时使用,caller属性返回的是对函数的引用，该函数调用了当前函数。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用Array对象的方法可以将arguments转换成数组</span></div><div class="line"><span class="keyword">var</span> argsArr = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</div></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[前端笔试题集大全]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[linux下创建服务]]></title>
    <link href="http://www.xuerlove.com/2017/02/07/linux%E4%B8%8B%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1/"/>
    <id>http://www.xuerlove.com/2017/02/07/linux下创建服务/</id>
    <published>2017-02-07T05:42:57.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="概述">概述</h4><p>我们通过在 /etc/init.d/ 目录下创建bash脚本，实现自定义服务，通过service命令，能够调用服务中的方法，通常一个服务存在 start stop restart status方法。<br><a id="more"></a></p>
<h4 id="例如">例如</h4><p>test<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"><span class="comment"># chkconfig: 2345 20 81</span></div><div class="line"><span class="comment"># description: test</span></div><div class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></div><div class="line">  start)</div><div class="line">  <span class="built_in">echo</span> -n <span class="string">"starting test:"</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">"OK"</span></div><div class="line">  ;;</div><div class="line">  stop)</div><div class="line">  <span class="built_in">echo</span> -n <span class="string">"shutdown test:"</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">"OK"</span></div><div class="line">  ;;</div><div class="line">  status)</div><div class="line">  <span class="built_in">echo</span> <span class="string">"test instance is running..."</span></div><div class="line">  ;;</div><div class="line">  restart)</div><div class="line">  <span class="variable">$0</span> stop</div><div class="line">  <span class="variable">$0</span> start</div><div class="line">  ;;</div><div class="line">  *)</div><div class="line">  <span class="built_in">echo</span> <span class="string">"Usage:`basename <span class="variable">$0</span>` start|stop|status|restart"</span></div><div class="line"><span class="keyword">esac</span></div><div class="line"><span class="built_in">exit</span> $?</div></pre></td></tr></table></figure></p>
<p>我们在 /etc/init.d/ 下面添加 test 脚本，然后给文件权限 sudo chmod -R 755, 之后我们就能够通过 </p>
<ul>
<li>sudo service start </li>
<li>sudo service stop </li>
<li>sudo service restart </li>
<li>sudo service status </li>
<li>sudo service<br>这些命令去调用我们的服务了</li>
</ul>
<h4 id="加入开机启动_chkconfig">加入开机启动 chkconfig</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">usage:   chkconfig [--list] [--type &lt;<span class="built_in">type</span>&gt;] [name]</div><div class="line">         chkconfig --add &lt;name&gt;</div><div class="line">         chkconfig --del &lt;name&gt;</div><div class="line">         chkconfig --override &lt;name&gt;</div><div class="line">         chkconfig [--level &lt;levels&gt;] [--type &lt;<span class="built_in">type</span>&gt;] &lt;name&gt; &lt;on|off|reset|resetpriorities&gt;</div></pre></td></tr></table></figure>
<p>sudo chkconfig –add test<br>sudo chkconfig test on</p>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="概述">概述</h4><p>我们通过在 /etc/init.d/ 目录下创建bash脚本，实现自定义服务，通过service命令，能够调用服务中的方法，通常一个服务存在 start stop restart status方法。<br>]]>
    
    </summary>
    
      <category term="linux" scheme="http://www.xuerlove.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[微信小程序开发]]></title>
    <link href="http://www.xuerlove.com/2016/11/03/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91/"/>
    <id>http://www.xuerlove.com/2016/11/03/微信小程序开发/</id>
    <published>2016-11-03T11:17:42.000Z</published>
    <updated>2017-02-17T06:15:18.000Z</updated>
    <content type="html"><![CDATA[<h5 id="准备">准备</h5><ul>
<li>开发环境<ul>
<li><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html" target="_blank" rel="external">下载开发工具</a></li>
<li><a href="https://github.com/gavinkwoe/weapp-ide-crack" target="_blank" rel="external">按照网上教程破解</a></li>
<li>或者直接下载破解好的包</li>
</ul>
</li>
<li>学习资料<ul>
<li><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/" target="_blank" rel="external">学习资料</a></li>
</ul>
</li>
</ul>
<a id="more"></a>
<h5 id="开始">开始</h5><ul>
<li>打开微信web开发者工具</li>
<li>AppID选择 无AppID 或者 随便写一个(破解后)</li>
<li>项目名称随便写</li>
<li>开发目录选择一个空的文件夹</li>
</ul>
<h5 id="项目目录">项目目录</h5><ul>
<li>文件<ul>
<li>app.js 必须 项目的主文件 小程序的逻辑</li>
<li>app.json 必须 小程序的公共设置</li>
<li>app.wxss 非必须 存放小程序的公共样式</li>
<li>各个文件编写规范以及配置的意义资料中讲的很详细,就不重新描述了。</li>
</ul>
</li>
<li>开发<br>这个小应用中调用了一些wx的组件以及API,实现了一个列表的下拉刷新，上拉加载，每一项的左划菜单(删除，收藏等),开发时间有限，实现的比较粗糙，主要是为了把小程序开发这一套走一遍，知道小程序想干什么，能干什么，怎么干。下面只贴了部分代码。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app.js</span></div><div class="line">App(&#123;</div><div class="line">  <span class="attr">onLaunch</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'App Launch'</span>)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">onShow</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'App Show'</span>)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">onHide</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'App Hide'</span>)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">globalData</span>: &#123;</div><div class="line">    <span class="attr">userInfo</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">nightMode</span>: <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app.json</span></div><div class="line">&#123;</div><div class="line">  <span class="string">"pages"</span>: [</div><div class="line">    <span class="string">"page/component/index/index"</span>,</div><div class="line">    <span class="string">"page/component/pic/pic"</span>,</div><div class="line">    <span class="string">"page/component/fav/fav"</span>,</div><div class="line">    <span class="string">"page/component/about/about"</span></div><div class="line">  ],</div><div class="line">  <span class="string">"window"</span>: &#123;</div><div class="line">    <span class="string">"navigationBarTextStyle"</span>: <span class="string">"white"</span>,</div><div class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"Jokes"</span>,</div><div class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#353336"</span>,</div><div class="line">    <span class="string">"backgroundColor"</span>: <span class="string">"#353336"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"tabBar"</span>: &#123;</div><div class="line">    <span class="string">"color"</span>: <span class="string">"#000000"</span>,</div><div class="line">    <span class="string">"selectedColor"</span>: <span class="string">"#ffffff"</span>,</div><div class="line">    <span class="string">"borderStyle"</span>: <span class="string">"black"</span>,</div><div class="line">    <span class="string">"backgroundColor"</span>: <span class="string">"#413f40"</span>,</div><div class="line">    <span class="string">"list"</span>: [&#123;</div><div class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/component/index/index"</span>,</div><div class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_jokes_default.png"</span>,</div><div class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_jokes_active.png"</span>,</div><div class="line">      <span class="string">"text"</span>: <span class="string">"Jokes"</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/component/pic/pic"</span>,</div><div class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_pic_default.png"</span>,</div><div class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_pic_active.png"</span>,</div><div class="line">      <span class="string">"text"</span>: <span class="string">"Jokes"</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/component/fav/fav"</span>,</div><div class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_fav_default.png"</span>,</div><div class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_fav_active.png"</span>,</div><div class="line">      <span class="string">"text"</span>: <span class="string">"fav"</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="string">"pagePath"</span>: <span class="string">"page/component/about/about"</span>,</div><div class="line">      <span class="string">"iconPath"</span>: <span class="string">"image/icon_settings_default.png"</span>,</div><div class="line">      <span class="string">"selectedIconPath"</span>: <span class="string">"image/icon_settings_active.png"</span>,</div><div class="line">      <span class="string">"text"</span>: <span class="string">"Settings"</span></div><div class="line">    &#125;]</div><div class="line">  &#125;,</div><div class="line">  <span class="string">"networkTimeout"</span>: &#123;</div><div class="line">    <span class="string">"request"</span>: <span class="number">10000</span>,</div><div class="line">    <span class="string">"connectSocket"</span>: <span class="number">10000</span>,</div><div class="line">    <span class="string">"uploadFile"</span>: <span class="number">10000</span>,</div><div class="line">    <span class="string">"downloadFile"</span>: <span class="number">10000</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"debug"</span>: <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// app.wxss</div><div class="line">page &#123;</div><div class="line">  background-color: #fbf9fe;</div><div class="line">  height: 100%;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// page/component/index/index.js</span></div><div class="line"><span class="keyword">var</span> jodeData,startX,startY,endX,endY,moveStart,</div><div class="line">    topAdImgs = [</div><div class="line">        <span class="string">'../../../image/ad/1.jpg'</span>,</div><div class="line">        <span class="string">'../../../image/ad/2.jpg'</span>,</div><div class="line">        <span class="string">'../../../image/ad/3.jpg'</span>,</div><div class="line">        <span class="string">'../../../image/ad/4.jpg'</span>,</div><div class="line">        <span class="string">'../../../image/ad/5.jpg'</span></div><div class="line">    ];</div><div class="line"></div><div class="line">Page(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">list</span>: [],</div><div class="line">    <span class="attr">itemToView</span>: <span class="string">''</span>,</div><div class="line">    <span class="attr">scrollTop</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">currentPage</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">bottomHidden</span>: <span class="string">'none'</span>,</div><div class="line">    <span class="attr">modalHidden</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">modalText</span>: <span class="string">''</span>,</div><div class="line">    <span class="attr">topImages</span>:topAdImgs,</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">colorMap</span>: [<span class="string">'#86a3c1'</span>,<span class="string">'#86d1cc'</span>,<span class="string">'#bdd4e4'</span>,<span class="string">'#debf88'</span>,<span class="string">'#f9af02'</span>],</div><div class="line">  <span class="attr">parse</span>: <span class="function"><span class="keyword">function</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">    html = html.replace(<span class="regexp">/(&lt;p&gt;)|(&lt;\/p&gt;)|(\t)|(&amp;nbsp;)/gm</span>, <span class="string">""</span>);</div><div class="line">    <span class="keyword">return</span> html;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">prefixData</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">var</span> favJokes = wx.getStorageSync(<span class="string">'favJokes'</span>) || [];</div><div class="line">    data.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,index</span>)</span>&#123;</div><div class="line">      item.ct = item.ct.substr(<span class="number">0</span>,<span class="number">19</span>);</div><div class="line">      <span class="keyword">if</span>(item.type === <span class="number">1</span>)&#123;</div><div class="line">        item.text = self.parse(item.text);  </div><div class="line">      &#125;</div><div class="line">      item.background = self.colorMap[index%<span class="number">5</span>];</div><div class="line">      item.right = <span class="string">'0%'</span>;</div><div class="line">      item.hidden = <span class="string">'block'</span>;</div><div class="line">      item.hasFav = <span class="string">'none'</span>;</div><div class="line">      favJokes.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">fitem,findex</span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(fitem.id === item.id)&#123;</div><div class="line">          item.hasFav = <span class="string">'block'</span>;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> data;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">onLoad</span>: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    wx.request(&#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">'https://123.test.com/joke_text?page='</span> + self.data.currentPage,</div><div class="line">      <span class="attr">data</span>: &#123;&#125;,</div><div class="line">      <span class="attr">header</span>: &#123;</div><div class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></div><div class="line">      &#125;,</div><div class="line">      <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> data = res.data;</div><div class="line">        data = self.prefixData(data);</div><div class="line">        self.setData(&#123;</div><div class="line">          <span class="attr">bottomHidden</span>: <span class="string">'none'</span></div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">if</span>(self.data.currentPage === <span class="number">1</span>)&#123;</div><div class="line">          self.setData(&#123;</div><div class="line">            <span class="attr">list</span>: data</div><div class="line">          &#125;);</div><div class="line">          self.toPos(self.data.currentPage);  </div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">          data = self.data.list.concat(data);</div><div class="line">          self.setData(&#123;</div><div class="line">            <span class="attr">list</span>: data</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        self.setData(&#123;</div><div class="line">          <span class="attr">bottomHidden</span>: <span class="string">'none'</span></div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">toPos</span>: <span class="function"><span class="keyword">function</span>(<span class="params">page</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      self.setData(&#123;</div><div class="line">        <span class="attr">itemToView</span>: <span class="string">'item'</span> + (page<span class="number">-1</span>) * <span class="number">20</span></div><div class="line">      &#125;);</div><div class="line">    &#125;,<span class="number">1000</span>);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">reDealData</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> allJodes = <span class="keyword">this</span>.data.list;</div><div class="line">    <span class="keyword">var</span> favJokes = wx.getStorageSync(<span class="string">'favJokes'</span>) || [];</div><div class="line">    allJodes.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,index</span>)</span>&#123;</div><div class="line">      item.hasFav = <span class="string">'none'</span>;</div><div class="line">      favJokes.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">fitem,findex</span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(fitem.id === item.id)&#123;</div><div class="line">          item.hasFav = <span class="string">'block'</span>;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">      <span class="attr">list</span>: allJodes</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">onShow</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.reDealData();</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">topUpdate</span>: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">      <span class="attr">currentPage</span>: <span class="number">1</span>,</div><div class="line">      <span class="attr">itemToView</span>: <span class="string">'top'</span></div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">this</span>.onLoad();</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">bottomLoad</span>: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> page = <span class="keyword">this</span>.data.currentPage;</div><div class="line">    page = page + <span class="number">1</span>;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">      <span class="attr">bottomHidden</span>: <span class="string">'block'</span>,</div><div class="line">      <span class="attr">currentPage</span>: page</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">this</span>.onLoad();</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">itemScroll</span>: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">itemClick</span>: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="comment">// wx.navigationTo(&#123;url:""&#125;);</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">itemStart</span>: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> touch = event.touches[<span class="number">0</span>];</div><div class="line">    startX = touch.clientX;</div><div class="line">    startY = touch.clientY;</div><div class="line">    moveStart = <span class="literal">true</span>;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">itemMove</span>: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">var</span> dataIndex = event.currentTarget.dataset.idx;</div><div class="line">    jodeData = <span class="keyword">this</span>.data.list;</div><div class="line">    <span class="keyword">if</span>(moveStart)&#123;</div><div class="line">      <span class="keyword">var</span> touch = event.touches[<span class="number">0</span>];</div><div class="line">      endX = touch.clientX;</div><div class="line">      endY = touch.clientY;</div><div class="line">      <span class="keyword">if</span>(<span class="built_in">Math</span>.abs(startX - endX) &gt;= <span class="built_in">Math</span>.abs(startY - endY))&#123;</div><div class="line">        <span class="keyword">if</span>(endX - startX &lt;= <span class="number">-5</span>)&#123;</div><div class="line">          jodeData.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,index</span>)</span>&#123;</div><div class="line">            item.right = <span class="string">'0%'</span>;</div><div class="line">          &#125;);</div><div class="line">          jodeData[dataIndex].right = <span class="string">"20%"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">          jodeData.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,index</span>)</span>&#123;</div><div class="line">            item.right = <span class="string">'0%'</span>;</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line">        self.setData(&#123;</div><div class="line">          <span class="attr">list</span>: jodeData</div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    moveStart = <span class="literal">false</span>;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">modalChange</span>:<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">      <span class="attr">modalHidden</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">modalText</span>: <span class="string">''</span></div><div class="line">    &#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">tapFav</span>:<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> dataIndex = event.currentTarget.dataset.idx;</div><div class="line">    <span class="keyword">var</span> allJodes = <span class="keyword">this</span>.data.list;</div><div class="line">    <span class="keyword">var</span> curJokes = allJodes[dataIndex];</div><div class="line">    curJokes.right = <span class="string">'0%'</span>;</div><div class="line">    <span class="keyword">var</span> favJokes = wx.getStorageSync(<span class="string">'favJokes'</span>) || [];</div><div class="line">    <span class="keyword">if</span>(curJokes.hasFav !== <span class="string">'block'</span>)&#123;</div><div class="line">      curJokes.hasFav = <span class="string">'block'</span>;</div><div class="line">      favJokes.unshift(curJokes);</div><div class="line">      wx.setStorageSync(<span class="string">'favJokes'</span>, favJokes);</div><div class="line">      <span class="keyword">this</span>.setData(&#123;</div><div class="line">        <span class="attr">list</span>: allJodes</div><div class="line">      &#125;);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">this</span>.setData(&#123;</div><div class="line">        <span class="attr">list</span>: allJodes,</div><div class="line">        <span class="attr">modalHidden</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">modalText</span>: <span class="string">'添加过了'</span></div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">tapDel</span>:<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> dataIndex = event.currentTarget.dataset.idx;</div><div class="line">    <span class="keyword">var</span> allJodes = <span class="keyword">this</span>.data.list;</div><div class="line">    <span class="keyword">var</span> curJokes = allJodes[dataIndex];</div><div class="line">    curJokes.right = <span class="string">'0%'</span>;</div><div class="line">    curJokes.hidden = <span class="string">'none'</span>;</div><div class="line">    <span class="keyword">this</span>.setData(&#123;</div><div class="line">      <span class="attr">list</span>: allJodes</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">// page/component/index/index.wxml</div><div class="line"><span class="tag">&lt;<span class="name">modal</span> <span class="attr">class</span>=<span class="string">"modal"</span> <span class="attr">hidden</span>=<span class="string">"&#123;&#123;modalHidden&#125;&#125;"</span> </span></div><div class="line">    <span class="attr">no-cancel</span> <span class="attr">bindconfirm</span>=<span class="string">"modalChange"</span>&gt;</div><div class="line">  <span class="tag">&lt;<span class="name">view</span>&gt;</span> &#123;&#123;modalText&#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">modal</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"index"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"body"</span>&gt;</span></div><div class="line">    	<span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">"top-swiper"</span> <span class="attr">indicator-dots</span>=<span class="string">"true"</span></span></div><div class="line">		  <span class="attr">autoplay</span>=<span class="string">"true"</span> <span class="attr">interval</span>=<span class="string">"5000"</span> <span class="attr">duration</span>=<span class="string">"1000"</span>&gt;</div><div class="line">		  <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;topImages&#125;&#125;"</span>&gt;</span></div><div class="line">		    <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span></div><div class="line">		      <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;item&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"slide-image"</span>/&gt;</span></div><div class="line">		    <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></div><div class="line">		  <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></div><div class="line">    	<span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">"scroll-view"</span> </span></div><div class="line">    	    <span class="attr">scroll-y</span>=<span class="string">"true"</span> <span class="attr">bindscrolltoupper</span>=<span class="string">"topUpdate"</span></div><div class="line">    	    <span class="attr">bindscrolltolower</span>=<span class="string">"bottomLoad"</span> <span class="attr">bindscroll</span>=<span class="string">"itemScroll"</span> </div><div class="line">    	    <span class="attr">scroll-into-view</span>=<span class="string">"&#123;&#123;itemToView&#125;&#125;"</span> </div><div class="line">    	    <span class="attr">scroll-top</span>=<span class="string">"&#123;&#123;scrollTop&#125;&#125;"</span> </div><div class="line">    	    <span class="attr">upper-threshold</span>=<span class="string">"20"</span> </div><div class="line">    	    <span class="attr">lower-threshold</span>=<span class="string">"30"</span>&gt;</div><div class="line">	    	<span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"list-container"</span>&gt;</span></div><div class="line">	    		<span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">"top"</span> <span class="attr">class</span>=<span class="string">"pull-update"</span>&gt;</span></div><div class="line">	    			正在更新</div><div class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">style</span>=<span class="string">"width: 30rpx; height: 30rpx;margin-left:10rpx;"</span> </span></div><div class="line">		            <span class="attr">mode</span>=<span class="string">"scaleToFill"</span> <span class="attr">src</span>=<span class="string">"../../../image/loading.gif"</span>&gt;<span class="tag">&lt;/<span class="name">image</span>&gt;</span></div><div class="line">	    		<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">		    	<span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">"&#123;&#123;list&#125;&#125;"</span>&gt;</span></div><div class="line">		        <span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">"item&#123;&#123;index&#125;&#125;"</span> <span class="attr">data-idx</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span> <span class="attr">class</span>=<span class="string">"item"</span></span></div><div class="line">		            <span class="attr">style</span>=<span class="string">"background:&#123;&#123;item.background&#125;&#125;;right:&#123;&#123;item.right&#125;&#125;;display:&#123;&#123;item.hidden&#125;&#125;;"</span> </div><div class="line">		            <span class="attr">bindtap</span>=<span class="string">"itemClick"</span> <span class="attr">bindtouchstart</span>=<span class="string">"itemStart"</span> <span class="attr">bindtouchmove</span>=<span class="string">"itemMove"</span>&gt;</div><div class="line">		        	<span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"info-container"</span>&gt;</span></div><div class="line">			          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"date"</span>&gt;</span></div><div class="line">			          	&#123;&#123;item.ct&#125;&#125;</div><div class="line">			          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">  			        <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;item.type == 1&#125;&#125;"</span>&gt;</span></div><div class="line">  						    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></div><div class="line">  			          	&#123;&#123;item.text&#125;&#125;</div><div class="line">  			          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">  					    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line">  					    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:else</span>&gt;</span></div><div class="line">  					  	  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></div><div class="line">  				          	<span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">"img-info"</span> <span class="attr">mode</span>=<span class="string">"aspectFit"</span> </span></div><div class="line">  				          	    <span class="attr">src</span>=<span class="string">"&#123;&#123;item.img&#125;&#125;"</span>&gt;<span class="tag">&lt;/<span class="name">image</span>&gt;</span></div><div class="line">  				          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">  				          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></div><div class="line">  				          	&#123;&#123;item.title&#125;&#125;</div><div class="line">  				          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">  					    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line">  			      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">		          <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">"fav-icon"</span> <span class="attr">mode</span>=<span class="string">"scaleToFill"</span> </span></div><div class="line">		            <span class="attr">src</span>=<span class="string">"../../../image/fav.png"</span> <span class="attr">style</span>=<span class="string">"display:&#123;&#123;item.hasFav&#125;&#125;"</span>&gt;<span class="tag">&lt;/<span class="name">image</span>&gt;</span></div><div class="line">        	    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"opt-item opt-fav"</span> <span class="attr">catchtap</span>=<span class="string">"tapFav"</span> <span class="attr">data-idx</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span>&gt;</span>喜欢<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">        	    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"opt-item opt-del"</span> <span class="attr">catchtap</span>=<span class="string">"tapDel"</span> <span class="attr">data-idx</span>=<span class="string">"&#123;&#123;index&#125;&#125;"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">		        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">			    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line">			    <span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">"bottom"</span> <span class="attr">class</span>=<span class="string">"pull-load"</span> <span class="attr">style</span>=<span class="string">"display:&#123;&#123;bottomHidden&#125;&#125;;"</span>&gt;</span></div><div class="line">	    			正在加载</div><div class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">style</span>=<span class="string">"width: 30rpx; height: 30rpx;margin-left:10rpx;"</span></span></div><div class="line">	    			            <span class="attr">mode</span>=<span class="string">"scaleToFill"</span> <span class="attr">src</span>=<span class="string">"../../../image/loading.gif"</span>&gt;<span class="tag">&lt;/<span class="name">image</span>&gt;</span></div><div class="line">	    		<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">			  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">	    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// page/component/index/index.wxss</span></div><div class="line">@<span class="keyword">import</span> <span class="string">'../../common/wxss/base.wxss'</span>;</div><div class="line">@<span class="keyword">import</span> <span class="string">'../../common/wxss/common.wxss'</span>;</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// page/common/wxss/base.wxss</div><div class="line">.index&#123;</div><div class="line">    background-color: #FBF9FE;</div><div class="line">    font-family: -apple-system-font,Helvetica Neue,Helvetica,sans-serif;</div><div class="line">    flex: 1;</div><div class="line">    min-height: 100%;</div><div class="line">    font-size: 32rpx;</div><div class="line">&#125;</div><div class="line">.body&#123;</div><div class="line">    overflow: hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line">// page/common/wxss/common.wxss</div><div class="line">.top-swiper&#123;</div><div class="line">    height: 300rpx;</div><div class="line">    width: 100%;</div><div class="line">&#125;</div><div class="line">.slide-image&#123;</div><div class="line">    height: 300rpx;</div><div class="line">    width: 100%;</div><div class="line">&#125;</div><div class="line">.scroll-view&#123;</div><div class="line">    height: 860rpx;</div><div class="line">&#125;</div><div class="line">.pic-view&#123;</div><div class="line">    height: 1160rpx;</div><div class="line">&#125;</div><div class="line">.list-container&#123;</div><div class="line">    margin: 40rpx 0;</div><div class="line">&#125;</div><div class="line">.pull-update&#123;</div><div class="line">    text-align: center;</div><div class="line">    height: 40rpx;</div><div class="line">    line-height: 40rpx;</div><div class="line">    margin-top: -40rpx;</div><div class="line">&#125;</div><div class="line">.pull-load&#123;</div><div class="line">    text-align: center;</div><div class="line">    height: 40rpx;</div><div class="line">    line-height: 40rpx;</div><div class="line">&#125;</div><div class="line">.item&#123;</div><div class="line">    position: relative;</div><div class="line">    display: block;</div><div class="line">    width: 100%;</div><div class="line">  text-align: left;</div><div class="line">  vertical-align: middle;</div><div class="line">  background-color: #fff;</div><div class="line">    border-radius: 3;</div><div class="line">    border: 0 none;</div><div class="line">    margin: 0;</div><div class="line">    min-height: 200rpx;</div><div class="line">    box-sizing: border-box;</div><div class="line">    transition: all .25s ease;</div><div class="line">    -webkit-transition: all .25s ease;</div><div class="line">&#125;</div><div class="line">.opt-item&#123;</div><div class="line">    position: absolute;</div><div class="line">    height: 100%;</div><div class="line">    width: 10%;</div><div class="line">    box-sizing: border-box;</div><div class="line">    padding-left: 20rpx;</div><div class="line">    min-height: 200rpx;</div><div class="line">    writing-mode: vertical-lr;</div><div class="line">    text-align: center;</div><div class="line">    vertical-align: middle;</div><div class="line">    display: inline-block;</div><div class="line">&#125;</div><div class="line">.opt-fav&#123;</div><div class="line">    color: #fff;</div><div class="line">    right: -10%;</div><div class="line">    background: #868484;</div><div class="line">&#125;</div><div class="line">.opt-del&#123;</div><div class="line">    color: #fff;</div><div class="line">    right: -20%;</div><div class="line">    background: #dc4545;</div><div class="line">&#125;</div><div class="line">.fav-del&#123;</div><div class="line">    color: #fff;</div><div class="line">    right: -10%;</div><div class="line">    background: #dc4545;</div><div class="line">&#125;</div><div class="line">.info-container&#123;</div><div class="line">    padding: 0 10rpx;</div><div class="line">&#125;</div><div class="line">.date&#123;</div><div class="line">    color: #fff;</div><div class="line">    text-align: left;</div><div class="line">    padding:18rpx 8rpx 8rpx 8rpx;</div><div class="line">&#125;</div><div class="line">.title&#123;</div><div class="line">    font-size: 28rpx;</div><div class="line">    color: #fff;</div><div class="line">    text-align: left;</div><div class="line">    padding:8rpx 8rpx 18rpx 8rpx;</div><div class="line">    color: #333;</div><div class="line">&#125;</div><div class="line">.content&#123;</div><div class="line">    font-size: 28rpx;</div><div class="line">    text-align: left;</div><div class="line">    padding:8rpx 8rpx 18rpx 8rpx;</div><div class="line">    color: #333;</div><div class="line">&#125;</div><div class="line">.blank-icon&#123;</div><div class="line">    margin: 0 auto;</div><div class="line">&#125;</div><div class="line">.fav-icon&#123;</div><div class="line">    position: absolute;</div><div class="line">    right: 0;</div><div class="line">    top: 0;</div><div class="line">    width: 60rpx;</div><div class="line">    height: 60rpx;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="简单理解">简单理解</h5><ul>
<li>小程序开发起来难度适中，主要是对框架，API以及组建的了解，开发过程中简单的拼凑，加上自己逻辑的串联，就可以完成一个小应用</li>
<li>对于前端开发来说，成本是非常低的，css，js语法一样，然后就是html，html就相当于我们使用一个新的模版引擎，更加强大的mustache</li>
<li>更像是hybrid开发，我们有调起原生的功能的能力，而又不需要去注册一堆方法(和app约定的方法),例如相册，定位，罗盘，网络，系统信息等</li>
<li>我们不用过多考虑路由的问题，兼容的问题</li>
<li>网络请求没有跨域产生的问题</li>
<li>解决了跨平台，多设备下的交互一致性</li>
</ul>
<h5 id="资料大全">资料大全</h5><p><a href="https://github.com/justjavac/awesome-wechat-weapp?hmsr=toutiao.io&amp;utm_medium=toutiao.io&amp;utm_source=toutiao.io" target="_blank" rel="external">资料大全</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h5 id="准备">准备</h5><ul>
<li>开发环境<ul>
<li><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html">下载开发工具</a></li>
<li><a href="https://github.com/gavinkwoe/weapp-ide-crack">按照网上教程破解</a></li>
<li>或者直接下载破解好的包</li>
</ul>
</li>
<li>学习资料<ul>
<li><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/">学习资料</a></li>
</ul>
</li>
</ul>]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[nodejs利用session做登录控制]]></title>
    <link href="http://www.xuerlove.com/2016/11/02/nodejs%E5%88%A9%E7%94%A8session%E5%81%9A%E7%99%BB%E5%BD%95%E6%8E%A7%E5%88%B6/"/>
    <id>http://www.xuerlove.com/2016/11/02/nodejs利用session做登录控制/</id>
    <published>2016-11-02T12:53:28.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="background">background</h4><p>&nbsp; &nbsp;&nbsp;&nbsp;登录的场景在我们日常应用中有很多，登录的实现过程大家都很清楚，无非就是拿着用户名密去数据库中查询，如果查到了就表示这个人是系统用户，可以登录并且使用系统。那么当用户访问系统页面的时候，我们怎么判断他是不是登录过了呢，这个时候就引出了session。<br>&nbsp; &nbsp;&nbsp;&nbsp;session翻译成会话，session的生命周期和浏览器的生命周期一致，session从创建的一刻起开始生效，浏览器关闭session销毁。session是客户端与服务器之间保持状态的解决方案。这种会话的匹配是通过cookie来实现的。</p>
<a id="more"></a>
<h4 id="express-session">express-session</h4><p>&nbsp; &nbsp;&nbsp;&nbsp;express-session是基于express框架的专门处理session的中间件，安装 <code>sudo npm install express-session --save</code> , session的解析过程需要用到cookieParser, 安装 <code>sudo npm install cookieParser --save</code> , 我们在使用的时候，只需要把express-session加入到中间件中，这样所有的路由就都能使用它了，我们可以在req.session中设置和读取session的值。</p>
<h5 id="应用">应用</h5><p>改造上一节中的例子，这里只介绍一些增加项<br>app.js (引用session，加入中间件)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">var session = <span class="built_in">require</span>(<span class="string">'express-session'</span>);</div><div class="line"><span class="keyword">var</span> cookieParser = <span class="built_in">require</span>(<span class="string">'cookie-parser'</span>);</div><div class="line">...</div><div class="line">...</div><div class="line">app.use(cookieParser());</div><div class="line">app.use(session(&#123;</div><div class="line">  <span class="attr">resave</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">saveUninitialized</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">name</span>: <span class="string">'user'</span>,</div><div class="line">  <span class="attr">cookie</span>: &#123; <span class="attr">maxAge</span>: <span class="number">80000</span> &#125;,</div><div class="line">  <span class="attr">secret</span>: <span class="string">'wz'</span></div><div class="line">&#125;));</div><div class="line">...</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>routes/index.js (路由中检查登录session是否存在)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">restrict</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (req.session.user) &#123;</div><div class="line">    next();</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    res.redirect(<span class="string">'/login.page'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">router.get(<span class="string">'/index.page'</span>,restrict, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</div><div class="line">  res.send(<span class="string">'success'</span>);</div><div class="line">&#125;);</div><div class="line">router.get(<span class="string">'/login.page'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</div><div class="line">  res.send(<span class="string">'login'</span>);</div><div class="line">&#125;);</div><div class="line">router.get(<span class="string">'/login'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>)</span>&#123;</div><div class="line">    login(req, res, next);</div><div class="line">&#125;);</div><div class="line">router.get(<span class="string">'/logout'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</div><div class="line">  req.session.destroy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    res.redirect(<span class="string">'/login.page'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>main/login.js (只增加了注释部分的代码)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">queryData</span>(<span class="params">req, res, next,query</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> query = query ? <span class="built_in">JSON</span>.parse(query) : &#123;&#125;;</div><div class="line">    pageModule.find(query).exec(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</div><div class="line">        res.writeHead(<span class="number">200</span>, &#123;</div><div class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json;charset=UTF-8"</span></div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">if</span>(err)&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(data &amp;&amp; data.length)&#123;</div><div class="line">            <span class="comment">//只增加了登录成功后，创建一个session的过程</span></div><div class="line">            req.session.user = data[<span class="number">0</span>].username;</div><div class="line">            dbSuccess.data = data;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbSuccess);</div><div class="line">            res.end(result);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="测试过程">测试过程</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> http:<span class="comment">//127.0.0.1:3000/index.page</span></div><div class="line"><span class="number">2.</span> http:<span class="comment">//127.0.0.1:3000/login?type=find</span></div><div class="line"><span class="number">3.</span> http:<span class="comment">//127.0.0.1:3000/index.page</span></div></pre></td></tr></table></figure>
<p>分别输入三个url，观察现象，第一个url输入的时候，因为不存在session,所以会跳转到登录页面，<br>第二个url为模拟登录过程，创建了一个session，第三个url访问主页，此时存在session,所以可以看到首页内容。</p>
<h4 id="express-session常用参数">express-session常用参数</h4><ul>
<li>cookie Object类型，设置cookie的一些属性</li>
<li>domain cookie作用域</li>
<li>expires cookie失效时间</li>
<li>httpOnly 禁止客户端访问</li>
<li>maxAge 实效时长</li>
<li>path cookie路径</li>
<li>name 这是session id的值</li>
<li>resave 允许重新设置session</li>
<li>saveUninitialized 是否session可以修改</li>
<li>secret cookie密钥</li>
<li>store session存储方式 mongodb等</li>
</ul>
<h4 id="express-session常用方法">express-session常用方法</h4><ul>
<li>Session.regenerate() 创建session</li>
<li>Session.destroy() 销毁session</li>
<li>Session.reload() 重载session</li>
<li>Session.save() 保存session</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="background">background</h4><p>&nbsp; &nbsp;&nbsp;&nbsp;登录的场景在我们日常应用中有很多，登录的实现过程大家都很清楚，无非就是拿着用户名密去数据库中查询，如果查到了就表示这个人是系统用户，可以登录并且使用系统。那么当用户访问系统页面的时候，我们怎么判断他是不是登录过了呢，这个时候就引出了session。<br>&nbsp; &nbsp;&nbsp;&nbsp;session翻译成会话，session的生命周期和浏览器的生命周期一致，session从创建的一刻起开始生效，浏览器关闭session销毁。session是客户端与服务器之间保持状态的解决方案。这种会话的匹配是通过cookie来实现的。</p>]]>
    
    </summary>
    
      <category term="nodejs" scheme="http://www.xuerlove.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[nodejs+mongodb]]></title>
    <link href="http://www.xuerlove.com/2016/10/31/nodejs-mongodb/"/>
    <id>http://www.xuerlove.com/2016/10/31/nodejs-mongodb/</id>
    <published>2016-10-31T12:53:27.000Z</published>
    <updated>2017-02-17T06:24:15.000Z</updated>
    <content type="html"><![CDATA[<p>这篇文章中，我们使用nodejs搭建简易服务器，然后开发一个登录过程中使用的增删改查接口，数据库使用mongoDB,操作数据库模块选用mongoose。</p>
<h4 id="创建nodejs工程">创建nodejs工程</h4><p>npm init<br>创建package.json文件</p>
<a id="more"></a>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"nodeblog"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"author"</span>: <span class="string">""</span>,</div><div class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="attr">"dependencies"</span>: &#123;</div><div class="line">    <span class="attr">"express"</span>: <span class="string">"^4.14.0"</span>,</div><div class="line">    <span class="attr">"mongoose"</span>: <span class="string">"^4.6.5"</span>,</div><div class="line">    <span class="attr">"url"</span>: <span class="string">"^0.11.0"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>dependencies中显示的是安装的依赖包，下面有安装过程，先不用考虑</p>
<h4 id="使用express">使用express</h4><p>sudo npm install express –save<br>快速构建web应用模块 资料: <a href="http://www.expressjs.com.cn/4x/api.html" target="_blank" rel="external">http://www.expressjs.com.cn/4x/api.html</a></p>
<h4 id="app-js">app.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</div><div class="line">  res.send(<span class="string">'hello world'</span>);</div><div class="line">&#125;);</div><div class="line">app.listen(<span class="number">3000</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'nodejs server start, listen port 3000'</span>);</div></pre></td></tr></table></figure>
<p>浏览器打开 <a href="http://127.0.0.1:3000/" target="_blank" rel="external">http://127.0.0.1:3000/</a> 页面显示 hello world</p>
<h4 id="使用mongoose">使用mongoose</h4><p>sudo npm install mongoose –save<br>数据库操作模块</p>
<h4 id="安装其他模块">安装其他模块</h4><p>sudo npm install url –save<br>辅助解析url参数</p>
<h4 id="nodejs操作数据库">nodejs操作数据库</h4><p>app.js 程序主文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"><span class="keyword">var</span> routes = <span class="built_in">require</span>(<span class="string">'./routes/index'</span>);</div><div class="line">app.use(<span class="string">'/'</span>, routes);</div><div class="line">app.listen(<span class="number">3000</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'nodejs server start, listen port 3000'</span>);</div></pre></td></tr></table></figure></p>
<p>routes/index.js 路由文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> router = express.Router();</div><div class="line"><span class="keyword">var</span> login = <span class="built_in">require</span>(<span class="string">'../main/login'</span>);</div><div class="line">router.get([<span class="string">'/login'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">    login(req, res, next);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">module</span>.exports = router;</div></pre></td></tr></table></figure></p>
<p>main/config.js 数据库配置文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> config = &#123;</div><div class="line">	<span class="attr">dbHost</span>: <span class="string">'127.0.0.1'</span>,</div><div class="line">	<span class="attr">dbPort</span>: <span class="string">'27017'</span>,</div><div class="line">	<span class="attr">dbAdmin</span>: <span class="string">'superuser'</span>,</div><div class="line">	<span class="attr">dbPassword</span>: <span class="string">'pwd'</span></div><div class="line">&#125;;</div><div class="line"><span class="built_in">module</span>.exports = config;</div></pre></td></tr></table></figure></p>
<p>main/loginSchema.js 数据库表结构<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</div><div class="line"><span class="keyword">var</span> loginSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</div><div class="line">	<span class="attr">username</span>: <span class="built_in">String</span>,</div><div class="line">	<span class="attr">userpassword</span>: <span class="built_in">String</span></div><div class="line">&#125;);</div><div class="line"><span class="built_in">module</span>.exports = loginSchema;</div></pre></td></tr></table></figure></p>
<p>main/login.js 登录增删改查逻辑文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>),</div><div class="line">    mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>),</div><div class="line">    loginSchema = <span class="built_in">require</span>(<span class="string">'./loginSchema'</span>),</div><div class="line">    config = <span class="built_in">require</span>(<span class="string">'./config'</span>);</div><div class="line"><span class="keyword">var</span> opt = &#123;</div><div class="line">        <span class="attr">user</span>: config.dbAdmin,</div><div class="line">        <span class="attr">pass</span>: config.dbPassword,</div><div class="line">        <span class="attr">auth</span>: &#123;</div><div class="line">            <span class="attr">authdb</span>: <span class="string">'admin'</span></div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    db = mongoose.createConnection(config.dbHost, <span class="string">'userinfo'</span>, config.dbPort, opt),</div><div class="line">    pageModule = db.model(<span class="string">"user"</span>, loginSchema);</div><div class="line"><span class="keyword">var</span> result,</div><div class="line">    dbSuccess = &#123;</div><div class="line">    	<span class="attr">ret</span>:<span class="literal">true</span>,</div><div class="line">    	<span class="attr">data</span>:&#123;&#125;</div><div class="line">    &#125;, </div><div class="line">    dbError = &#123;</div><div class="line">    	<span class="attr">ret</span>:<span class="literal">false</span>,</div><div class="line">    	<span class="attr">data</span>:<span class="string">'fail'</span></div><div class="line">    &#125;;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *  存储数据</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveData</span>(<span class="params">req, res, next, pageData</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> pageDataModule = <span class="keyword">new</span> pageModule(<span class="built_in">JSON</span>.parse(pageData));</div><div class="line">    pageDataModule.save(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">        res.writeHead(<span class="number">200</span>, &#123;</div><div class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json;charset=UTF-8"</span></div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">if</span>(err)&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">        dbSuccess.data = <span class="string">'操作成功'</span>;</div><div class="line">        result = <span class="built_in">JSON</span>.stringify(dbSuccess);</div><div class="line">        res.end(result);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *  删除数据</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteData</span>(<span class="params">req, res, next,query</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> query = query ? <span class="built_in">JSON</span>.parse(query) : &#123;&#125;;</div><div class="line">    pageModule.remove(query).exec(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</div><div class="line">        res.writeHead(<span class="number">200</span>, &#123;</div><div class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json;charset=UTF-8"</span></div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">if</span>(err)&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">        dbSuccess.data = <span class="string">'操作成功'</span>;</div><div class="line">        result = <span class="built_in">JSON</span>.stringify(dbSuccess);</div><div class="line">        res.end(result);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *  更新数据</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateData</span>(<span class="params">req, res, next,query, pageData</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> query = query ? <span class="built_in">JSON</span>.parse(query) : &#123;&#125;;</div><div class="line">    pageData = <span class="built_in">JSON</span>.parse(pageData);</div><div class="line">    pageModule.findOneAndUpdate(query, pageData).exec(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</div><div class="line">        res.writeHead(<span class="number">200</span>, &#123;</div><div class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json;charset=UTF-8"</span></div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">if</span>(err)&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">        dbSuccess.data = <span class="string">'操作成功'</span>;</div><div class="line">        result = <span class="built_in">JSON</span>.stringify(dbSuccess);</div><div class="line">        res.end(result);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *  查询数据</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">queryData</span>(<span class="params">req, res, next,query</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> query = query ? <span class="built_in">JSON</span>.parse(query) : &#123;&#125;;</div><div class="line">    pageModule.find(query).exec(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</div><div class="line">        res.writeHead(<span class="number">200</span>, &#123;</div><div class="line">            <span class="string">"Content-Type"</span>: <span class="string">"application/json;charset=UTF-8"</span></div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">if</span>(err)&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(data &amp;&amp; data.length)&#123;</div><div class="line">            dbSuccess.data = data;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbSuccess);</div><div class="line">            res.end(result);</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            result = <span class="built_in">JSON</span>.stringify(dbError);</div><div class="line">            res.end(result);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"> *  增删改查入口</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">req, res, next</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> queryObj = url.parse(<span class="built_in">decodeURIComponent</span>(req.url), <span class="literal">true</span>).query,</div><div class="line">	    type = queryObj.type,</div><div class="line">	    query = queryObj.query,</div><div class="line">	    pageData = queryObj.pageData;</div><div class="line">	<span class="keyword">switch</span>(type)&#123;</div><div class="line">		<span class="keyword">case</span> <span class="string">'add'</span>:</div><div class="line">			saveData(req, res, next,pageData);</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">case</span> <span class="string">'delete'</span>:</div><div class="line">			deleteData(req, res, next,query);</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">case</span> <span class="string">'update'</span>:</div><div class="line">			updateData(req, res, next,query, pageData)</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">case</span> <span class="string">'find'</span>:</div><div class="line">			queryData(req, res, next,query)</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">default</span>:</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = login;</div></pre></td></tr></table></figure></p>
<h4 id="测试url">测试url</h4><p>1.<a href="http://127.0.0.1:3000/login?type=add&amp;pageData={&quot;username&quot;:&quot;wz&quot;,&quot;userpassword&quot;:&quot;wz&quot;}" target="_blank" rel="external">http://127.0.0.1:3000/login?type=add&amp;pageData={&quot;username&quot;:&quot;wz&quot;,&quot;userpassword&quot;:&quot;wz&quot;}</a><br>2.<a href="http://127.0.0.1:3000/login?type=find" target="_blank" rel="external">http://127.0.0.1:3000/login?type=find</a><br>3.<a href="http://127.0.0.1:3000/login?type=update&amp;query={&quot;username&quot;:&quot;wz&quot;}&amp;pageData={&quot;username&quot;:&quot;ww&quot;,&quot;userpassword&quot;:&quot;wz&quot;}" target="_blank" rel="external">http://127.0.0.1:3000/login?type=update&amp;query={&quot;username&quot;:&quot;wz&quot;}&amp;pageData={&quot;username&quot;:&quot;ww&quot;,&quot;userpassword&quot;:&quot;wz&quot;}</a><br>4.<a href="http://127.0.0.1:3000/login?type=delete&amp;query={&quot;username&quot;:&quot;ww&quot;}" target="_blank" rel="external">http://127.0.0.1:3000/login?type=delete&amp;query={&quot;username&quot;:&quot;ww&quot;}</a><br>提供的测试url分别做了：1 向数据库中插入一条数据，2 在数据库中查找users表中所有数据，3 修改第一步中添加的数据，4 删除第三步中修改的数据。都以json格式返回给客户端。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>这篇文章中，我们使用nodejs搭建简易服务器，然后开发一个登录过程中使用的增删改查接口，数据库使用mongoDB,操作数据库模块选用mongoose。</p>
<h4 id="创建nodejs工程">创建nodejs工程</h4><p>npm init<br>创建package.json文件</p>]]>
    
    </summary>
    
      <category term="nodejs" scheme="http://www.xuerlove.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[mongodb]]></title>
    <link href="http://www.xuerlove.com/2016/10/31/mongodb/"/>
    <id>http://www.xuerlove.com/2016/10/31/mongodb/</id>
    <published>2016-10-31T11:57:13.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="环境">环境</h4><ul>
<li>centeros</li>
</ul>
<h4 id="下载">下载</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget http:<span class="comment">//fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.2.10.tgz</span></div></pre></td></tr></table></figure>
<h4 id="解压">解压</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo tar -zxvf mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>.tgz</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="加入PATH">加入PATH</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span></div><div class="line"><span class="keyword">export</span> PATH=<span class="regexp">/home/</span>q/mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>/bin:$PATH</div></pre></td></tr></table></figure>
<h4 id="创建基础文件">创建基础文件</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p data/db</div><div class="line">sudo mkdir logs</div><div class="line">sudo vim ./bin/mongodb.conf</div><div class="line"></div><div class="line">#加入内容</div><div class="line">port=27017</div><div class="line">dbpath=/home/q/mongodb-linux-x86_64-3.2.10/data/db</div><div class="line">logpath=/home/q/mongodb-linux-x86_64-3.2.10/logs/db.logs</div><div class="line">logappend=true</div></pre></td></tr></table></figure>
<h4 id="启动服务">启动服务</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mongod -config /home/q/mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>/bin/mongodb.conf  --fork --auth</div></pre></td></tr></table></figure>
<h4 id="连接数据库">连接数据库</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongo</div></pre></td></tr></table></figure>
<h4 id="添加用户">添加用户</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">use admin</div><div class="line">db.createUser(</div><div class="line">  &#123;</div><div class="line">    <span class="attr">user</span>:<span class="string">"superuser"</span>,</div><div class="line">    <span class="attr">pwd</span>:<span class="string">"pwd"</span>,</div><div class="line">    <span class="attr">roles</span>:[<span class="string">"root"</span>]</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h4 id="认证">认证</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">use admin</div><div class="line">db.auth(<span class="string">'superuser'</span>,<span class="string">'pwd'</span>)</div></pre></td></tr></table></figure>
<h4 id="添加用户-1">添加用户</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">db.createUser(</div><div class="line">   &#123;</div><div class="line">     <span class="attr">user</span>: <span class="string">"zhuo.wu"</span>,</div><div class="line">     <span class="attr">pwd</span>: <span class="string">"zhuo.wu"</span>,</div><div class="line">     <span class="attr">roles</span>: [ <span class="string">"readWrite"</span>, <span class="string">"dbAdmin"</span> ]</div><div class="line">   &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h4 id="查看用户">查看用户</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">show users</div></pre></td></tr></table></figure>
<h4 id="创建数据库">创建数据库</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">use testDB</div></pre></td></tr></table></figure>
<h4 id="创建集合">创建集合</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">db.test.insert(&#123;<span class="string">'k'</span>:<span class="string">'123'</span>&#125;)</div><div class="line">show dbs</div><div class="line">db.test.find()</div></pre></td></tr></table></figure>
<h4 id="删除集合">删除集合</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.test.drop()</div></pre></td></tr></table></figure>
<h4 id="删除数据库">删除数据库</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.dropDatabase()</div></pre></td></tr></table></figure>
<h4 id="数据库备份">数据库备份</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mongodump -u=superuser -p=pwd</div><div class="line">#mongodump -h dbhost -d dbname -o dbdirectory</div></pre></td></tr></table></figure>
<h4 id="数据库恢复">数据库恢复</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mongodump -u=superuser -p=pwd</div><div class="line">#mongorestore -h dbhost -d dbname --directoryperdb dbdirectory</div></pre></td></tr></table></figure>
<h4 id="定时备份数据库">定时备份数据库</h4><ul>
<li><p>备份目录</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p /home/mongo/temp &amp;&amp; sudo chmod -R <span class="number">777</span> /home/mongo/temp</div><div class="line">sudo mkdir -p /home/mongo/all &amp;&amp; sudo chmod -R <span class="number">777</span> /home/mongo/all</div></pre></td></tr></table></figure>
</li>
<li><p>备份脚本<br>sudo vim /home/schedule/mongo.sh</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line">user=superuser</div><div class="line">passwprd=pwd</div><div class="line">deldays=<span class="number">2</span></div><div class="line">backdate=<span class="string">`date +%Y-%m-%d`</span></div><div class="line">backname=<span class="string">"mg_$backdate.tar.gz"</span></div><div class="line">mongodump=<span class="regexp">/home/</span>q/mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>/bin/mongodump</div><div class="line">temp=<span class="regexp">/home/m</span>ongo/temp</div><div class="line">all=<span class="regexp">/home/m</span>ongo/all</div><div class="line">cd $temp</div><div class="line">rm -rf $temp<span class="comment">/*</span></div><div class="line">mkdir -p $temp/$backdate</div><div class="line">$mongodump -u $user -p $passwprd -o $temp/$backdate</div><div class="line">tar -zcvf $all/$backname $temp/$backdate</div><div class="line">find $all/ -mtime +$deldays -delete</div></pre></td></tr></table></figure>
</li>
<li><p>修改权限</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod -R <span class="number">777</span> /home/schedule/mongo.sh</div></pre></td></tr></table></figure>
</li>
<li><p>定时任务<br>sudo vim /etc/crontab</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">40</span> <span class="number">18</span> * * * root /home/schedule/mongo.sh</div></pre></td></tr></table></figure>
</li>
<li><p>重启定时任务</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/rc.d/init.d/crond restart</div></pre></td></tr></table></figure>
</li>
<li><p>开机启动</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chkconfig crond on</div></pre></td></tr></table></figure>
</li>
<li><p>启动服务</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service crond start</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="关闭数据库">关闭数据库</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">use admin</div><div class="line">db.auth('superuser','pwd')</div><div class="line">db.shutdownServer()</div><div class="line">#or</div><div class="line">db.adminCommand(&#123;shutdown : 1, force : true&#125;)</div><div class="line">#or</div><div class="line">db.shutdownServer(&#123;force : true&#125;)</div></pre></td></tr></table></figure>
<h4 id="常见问题">常见问题</h4><ul>
<li>数据库非正常关闭lock<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo rm -rf /home/q/mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>/data/db/mongod.lock</div><div class="line">sudo mongod --dbpath /home/q/mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>/data/db --repair</div><div class="line">sudo ./mongod --dbpath /home/q/mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>/data/db</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="推荐数据库软件">推荐数据库软件</h4><ul>
<li>Mac: Toad (app store)</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="环境">环境</h4><ul>
<li>centeros</li>
</ul>
<h4 id="下载">下载</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget http:<span class="comment">//fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.2.10.tgz</span></div></pre></td></tr></table></figure>
<h4 id="解压">解压</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo tar -zxvf mongodb-linux-x86_64<span class="number">-3.2</span><span class="number">.10</span>.tgz</div></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="linux" scheme="http://www.xuerlove.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[fetch]]></title>
    <link href="http://www.xuerlove.com/2016/08/31/fetch/"/>
    <id>http://www.xuerlove.com/2016/08/31/fetch/</id>
    <published>2016-08-31T13:17:37.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h5 id="介绍">介绍</h5><ul>
<li>遵循Promise解决方案</li>
<li>XMLHttpRequest的替代者</li>
</ul>
<h5 id="使用">使用</h5><ul>
<li>引入Promise兼容方案</li>
<li>引入fetch兼容方案（高级浏览器高版本已经支持）</li>
<li>兼容方案以及使用说明见 <a href="https://github.com/github/fetch" target="_blank" rel="external">https://github.com/github/fetch</a><a id="more"></a>
</li>
</ul>
<h5 id="详解">详解</h5><h6 id="Header">Header</h6><h6 id="Request">Request</h6><h6 id="Response">Response</h6><h5 id="示例">示例</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkStatus</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (response.status &gt;= <span class="number">200</span> &amp;&amp; response.status &lt; <span class="number">300</span>) &#123;</div><div class="line">    <span class="keyword">return</span> response</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">var</span> error = <span class="keyword">new</span> <span class="built_in">Error</span>(response.statusText)</div><div class="line">    error.response = response</div><div class="line">    <span class="keyword">throw</span> error</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseJSON</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> response.json()</div><div class="line">&#125;</div><div class="line"></div><div class="line">fetch(<span class="string">'/test.json'</span>)</div><div class="line">  .then(checkStatus)</div><div class="line">  .then(parseJSON)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'request succeeded with JSON response'</span>, data)</div><div class="line">  &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'request failed'</span>, error)</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h5 id="介绍">介绍</h5><ul>
<li>遵循Promise解决方案</li>
<li>XMLHttpRequest的替代者</li>
</ul>
<h5 id="使用">使用</h5><ul>
<li>引入Promise兼容方案</li>
<li>引入fetch兼容方案（高级浏览器高版本已经支持）</li>
<li>兼容方案以及使用说明见 <a href="https://github.com/github/fetch">https://github.com/github/fetch</a>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://www.xuerlove.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[移动端开发性能优化]]></title>
    <link href="http://www.xuerlove.com/2016/04/14/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <id>http://www.xuerlove.com/2016/04/14/移动端开发性能优化/</id>
    <published>2016-04-14T02:43:35.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h5 id="介绍">介绍</h5><p>移动端这几年可以说发展的特别快，并且以绝对的优势超过了pc端，所以移动端的应用也越来越多，越来越重要。移动端不同于pc端，从设备的性能，网络差异，屏幕大小都有很大的差异，所以移动端的性能要尤为注意，力争我们的网站在移动端性能达到最佳。</p>
<a id="more"></a>
<h5 id="代码">代码</h5><p>从代码层面讲，务必做到精简，高效。移动端平台分ios android windows phone等，每个平台又有很多手机生产商，每种手机的性能又差异很大，还有些厂商还会自己定制浏览器内核，等等因素吧，导致了移动端经常出现各种差异性的表现，常常顾此失彼。那么就要求我们写的代码效率高一些，逻辑精简些，从程序层面减少因性能带来的问题，这是最好的方法去避免出现一些奇葩问题。还要做好一系列的异常处理措施，不要让代码出现报错的情况。减少dom操作，增加数据缓存机制，离线数据处理等，另外代码的精简也可以让页面下载资源的时间减少。</p>
<h5 id="框架">框架</h5><p>最近在开发过程中，使用了reactjs这个框架，不得不说这个框架应用起来还是比较顺利的，从开发到最终的页面表现来说，都是比较满意的。但是有一个问题是，在生成的代码中会生成过多的dom节点，这一点需要注意一下。因为在hybrid中，dom元素过多可能会影响页面性能，甚至导致app崩溃。</p>
<h5 id="组件">组件</h5><p>应用第三方组件，要慎重考虑，这里就拿iscroll来说，这个组建无疑优化了滑动的体验，但是它是非常耗性能的，还有就是安卓手机上的表现并不理想，在一些滚动监听上也存在问题。</p>
<h5 id="布局与css">布局与css</h5><p>合理的布局能够有效的减少显示上的bug，常见的就是fixed的问题，以及input框和软键盘的问题。</p>
<h5 id="硬件加速">硬件加速</h5><p>硬件加速是一件好事，但是它的弊端也显露无疑，电池耗电快，手机发热等等</p>
<h5 id="优化点">优化点</h5><ul>
<li>合并域名，减少dns解析的时间</li>
<li>请求数量尽量少，相应的数据尽量精简</li>
<li>请求尽量并发，不要串行</li>
<li>静态资源使用单独的域名，做到cookie free，有条件的话使用cdn</li>
<li>合并小图标，使用雪碧图，使用font代替图标</li>
<li>去掉没用cookie，cookie命名尽量简短，cookie值尽量精简</li>
<li>完善本地缓存数据（优先展示出缓存数据，数据返回后再更新）</li>
<li>注意jsonp的请求，jsonp会阻塞页面加载，阻塞页面操作，做好超时异常判断</li>
<li>压缩html中的空格换行，使用gzip压缩</li>
<li>css规则不要太复杂，去掉没用的css，css放在head中，js放在body底部</li>
<li>尽量使用原生方法</li>
<li>减少dom操作，尽量缓存dom</li>
<li>touch端应该考虑使用离线存储(cache manifest)</li>
<li>hybrid尽量使用离线包机制</li>
<li>对于过长的页面，应该考虑优先加载精简页面(短页面)，点击底部加载更多按钮，根据当前gps,network记录当前网络情况(页面其余部分加载时间小于一定范围即可以认定网络好)，下次在一定范围内打开页面默认加载全的页面，否则展示精简页面，对一些低版本的系统，可以让它永远展示精简页面，查看全部才能看到全部内容，这样能够保证用户看到页面的速度</li>
<li>页面内容按需加载，模块可以使用滚动加载，图片使用懒加载</li>
<li>页面渲染尽量不要依赖接口数据返回，接口的不稳定性可能会拖累页面加载时间</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[移动端开发性能优化]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[reactjs应用]]></title>
    <link href="http://www.xuerlove.com/2016/04/14/reactjs%E5%BA%94%E7%94%A8/"/>
    <id>http://www.xuerlove.com/2016/04/14/reactjs应用/</id>
    <published>2016-04-14T02:42:32.000Z</published>
    <updated>2017-02-17T06:24:42.000Z</updated>
    <content type="html"><![CDATA[<h4 id="reactjs">reactjs</h4><p>官方文档 <a href="http://reactjs.cn/react/docs/getting-started.html" target="_blank" rel="external">http://reactjs.cn/react/docs/getting-started.html</a></p>
<h5 id="引用reactjs框架">引用reactjs框架</h5><ul>
<li>实时转换工具 <code>npm install -g react-tools</code> 启动命令 <code>jsx --watch src/ build/</code> （或者页面引入jsx编译工具）</li>
<li>引入fetch <a href="https://github.com/github/fetch" target="_blank" rel="external">https://github.com/github/fetch</a> （引入Promise）</li>
<li>jsx <a href="http://reactjs.cn/react/docs/jsx-in-depth.html" target="_blank" rel="external">http://reactjs.cn/react/docs/jsx-in-depth.html</a><a id="more"></a>
</li>
</ul>
<h5 id="过程">过程</h5><ul>
<li>通过 React.createClass 定义组件</li>
<li>组件包含的属性，方法(<a href="http://reactjs.cn/react/docs/component-specs.html" target="_blank" rel="external">http://reactjs.cn/react/docs/component-specs.html</a>)<ul>
<li>render</li>
<li>getInitialState</li>
<li>getDefaultProps</li>
<li>propTypes</li>
<li>mixins</li>
<li>statics</li>
<li>displayName</li>
</ul>
</li>
<li>生命周期方法(<a href="http://reactjs.cn/react/docs/component-specs.html" target="_blank" rel="external">http://reactjs.cn/react/docs/component-specs.html</a>)<ul>
<li>componentWillMount</li>
<li>componentDidMount</li>
<li>componentWillReceiveProps</li>
<li>shouldComponentUpdate</li>
<li>componentWillUpdate</li>
<li>componentDidUpdate</li>
<li>componentWillUnmount</li>
</ul>
</li>
<li>组件生命周期<br>了解组件的生命周期很重要，这在我们哪个阶段去调用什么方法是有帮助的，下面就一起来看一下：</li>
</ul>
<ol>
<li>getInitialState<ul>
<li>在组件类创建的时候只调用一次，返回值是 this.state 的初始值</li>
</ul>
</li>
<li>componentWillMount<ul>
<li>初始化渲染之前只调用一次，如果在这个阶段setState，更新将会通知render</li>
</ul>
</li>
<li>render<ul>
<li>会根据this.props或者this.state渲染组件</li>
</ul>
</li>
<li>componentDidMount<ul>
<li>在初始化渲染之后只调用一次，可以操作dom和浏览器交互，通过this.DOMNode()获取DOM节点</li>
</ul>
</li>
<li>componentWillReceiveProps<ul>
<li>组件接收到新的props都会调用，初始化的时候不会调用这个方法，可以在这里面更新this.state</li>
</ul>
</li>
<li>componentWillUpdate<ul>
<li>在接收到新的props或者state之前的时候调用，初始化渲染的时候不会调用，里面做更新前的准备工作，不能在里面setState</li>
</ul>
</li>
<li><p>shouldComponentUpdate</p>
<ul>
<li><p>在接收到新的props或者state的时候，渲染之前调用，在初始化的时候不会调用，如果确定新的props和state不会导致组件更新，可以返回false,默认返回true</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">shouldComponentUpdate: <span class="function"><span class="keyword">function</span>(<span class="params">nextProps, nextState</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> nextProps.id !== <span class="keyword">this</span>.props.id;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>这个方法可以提升程序性能，一些依赖父级props，组件本身会发送请求的情况，可以判断传入props是否是更新后的，然后再去执行接下来的动作。</p>
</li>
</ul>
</li>
<li>componentDidUpdate<ul>
<li>组件更新到DOM中被调用，初始化的时候不会调用，对dom的操作可以放在这里面执行</li>
</ul>
</li>
<li>componentWillUnmount<ul>
<li>组件从dom中移除的时候调用，这个方法中清除一些定时操作等</li>
</ul>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="reactjs">reactjs</h4><p>官方文档 <a href="http://reactjs.cn/react/docs/getting-started.html">http://reactjs.cn/react/docs/getting-started.html</a></p>
<h5 id="引用reactjs框架">引用reactjs框架</h5><ul>
<li>实时转换工具 <code>npm install -g react-tools</code> 启动命令 <code>jsx --watch src/ build/</code> （或者页面引入jsx编译工具）</li>
<li>引入fetch <a href="https://github.com/github/fetch">https://github.com/github/fetch</a> （引入Promise）</li>
<li>jsx <a href="http://reactjs.cn/react/docs/jsx-in-depth.html">http://reactjs.cn/react/docs/jsx-in-depth.html</a>]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[nodejs开发控制台工具]]></title>
    <link href="http://www.xuerlove.com/2016/04/14/nodejs%E5%BC%80%E5%8F%91%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%B7%A5%E5%85%B7/"/>
    <id>http://www.xuerlove.com/2016/04/14/nodejs开发控制台工具/</id>
    <published>2016-04-14T02:41:56.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="环境要求">环境要求</h4><ul>
<li>nodejs</li>
</ul>
<h4 id="基本文件结构">基本文件结构</h4><ul>
<li>package.json <ul>
<li>使用npm init生成</li>
<li>安装依赖模块使用 npm install 模块名</li>
</ul>
</li>
<li>一个主文件 index.js</li>
</ul>
<a id="more"></a>
<h4 id="例子：">例子：</h4><ul>
<li><p>package.json</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"node-translate"</span>,</div><div class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="string">"description"</span>: <span class="string">"translate"</span>,</div><div class="line">  <span class="string">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"bin"</span>: &#123;</div><div class="line">    <span class="string">"trans"</span>: <span class="string">"./index.js"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"author"</span>: <span class="string">"黑卓"</span>,</div><div class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="string">"dependencies"</span>: &#123;</div><div class="line">    <span class="string">"color"</span>: <span class="string">"^0.11.1"</span>,</div><div class="line">    <span class="string">"colors"</span>: <span class="string">"^1.1.2"</span>,</div><div class="line">    <span class="string">"commander"</span>: <span class="string">"^2.9.0"</span>,</div><div class="line">    <span class="string">"request"</span>: <span class="string">"^2.70.0"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#! /usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * @Author: 黑卓</div><div class="line"> * @Date:   2016-04-07 15:47:33</div><div class="line"> * @Last Modified by:   黑卓</div><div class="line"> * @Last Modified time: 2016-04-07 17:56:40</div><div class="line"> */</div><div class="line"><span class="meta"></span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">'request'</span>);</div><div class="line"><span class="keyword">var</span> colors = <span class="built_in">require</span>(<span class="string">'colors'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</div><div class="line">program.version(<span class="string">'0.0.1'</span>).parse(process.argv);</div><div class="line"></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> param = process.argv[<span class="number">2</span>];</div><div class="line"></div><div class="line">	<span class="keyword">var</span> word = param ? param : <span class="string">''</span>;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (!word) &#123;</div><div class="line">		<span class="built_in">console</span>.log(<span class="string">'请输入要查询的单词'</span>.underline.red);</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">console</span>.log(<span class="string">''</span>);</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'要翻译的单词 : '</span>.green + <span class="string">' : '</span> + word.underline.red);</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">''</span>);</div><div class="line"></div><div class="line">	<span class="keyword">var</span> option = &#123;</div><div class="line">		<span class="attr">from</span>: <span class="string">'zh'</span>,</div><div class="line">		<span class="attr">to</span>: <span class="string">'en'</span>,</div><div class="line">		<span class="attr">query</span>: <span class="built_in">encodeURIComponent</span>(word)</div><div class="line">	&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (<span class="regexp">/^[A-Za-z ]+$/</span>.test(word.trim())) &#123;</div><div class="line">		option.from = <span class="string">'en'</span>;</div><div class="line">		option.to = <span class="string">'zh'</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> url = <span class="string">'http://test.com'</span>; <span class="comment">// 这里换成了假url</span></div><div class="line"></div><div class="line">	<span class="keyword">var</span> paramArray = [];</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">in</span> option) &#123;</div><div class="line">		<span class="keyword">var</span> pStr = item + <span class="string">'='</span> + option[item];</div><div class="line">		paramArray.push(pStr);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	url += <span class="string">'?'</span> + paramArray.join(<span class="string">'&amp;'</span>);</div><div class="line"></div><div class="line">	request(url, <span class="function"><span class="keyword">function</span>(<span class="params">error, response, data</span>) </span>&#123;</div><div class="line">		<span class="keyword">if</span> (!error &amp;&amp; response.statusCode == <span class="number">200</span>) &#123;</div><div class="line">			data = <span class="built_in">JSON</span>.parse(data);</div><div class="line">			<span class="keyword">if</span> (data &amp;&amp; data.result) &#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">'翻译结果 : '</span>.green + data.result.dst.underline.red || <span class="string">'没有查询到结果'</span>.underline.red);</div><div class="line">			&#125; <span class="keyword">else</span> &#123;</div><div class="line">				<span class="built_in">console</span>.log(<span class="string">'没有查询到结果'</span>.underline.red);</div><div class="line">			&#125;</div><div class="line">			<span class="built_in">console</span>.log(<span class="string">''</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="链接到全局">链接到全局</h4><p>npm link</p>
<h4 id="自行发布">自行发布</h4><h4 id="request">request</h4><p>request模块让http请求变的简单,<a href="https://www.npmjs.com/package/request" target="_blank" rel="external">https://www.npmjs.com/package/request</a></p>
<h4 id="colors">colors</h4><p>终端着色colors插件,<a href="https://www.npmjs.com/package/colors" target="_blank" rel="external">https://www.npmjs.com/package/colors</a></p>
<h4 id="program">program</h4><p>nodejs命令行参数处理模块commander,<a href="https://www.npmjs.com/package/commander" target="_blank" rel="external">https://www.npmjs.com/package/commander</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="环境要求">环境要求</h4><ul>
<li>nodejs</li>
</ul>
<h4 id="基本文件结构">基本文件结构</h4><ul>
<li>package.json <ul>
<li>使用npm init生成</li>
<li>安装依赖模块使用 npm install 模块名</li>
</ul>
</li>
<li>一个主文件 index.js</li>
</ul>]]>
    
    </summary>
    
      <category term="nodejs" scheme="http://www.xuerlove.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[npm包开发]]></title>
    <link href="http://www.xuerlove.com/2016/04/14/npm%E5%8C%85%E5%BC%80%E5%8F%91/"/>
    <id>http://www.xuerlove.com/2016/04/14/npm包开发/</id>
    <published>2016-04-14T02:41:29.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="环境要求">环境要求</h4><ul>
<li>nodejs</li>
</ul>
<h4 id="基本文件结构">基本文件结构</h4><ul>
<li>package.json <ul>
<li>使用npm init生成</li>
<li>安装依赖模块使用 npm install 模块名</li>
</ul>
</li>
<li>一个主文件 index.js</li>
<li>一个lib文件夹<ul>
<li>存放源文件<a id="more"></a>
</li>
</ul>
</li>
</ul>
<h4 id="例子">例子</h4><ul>
<li><p>package.json</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"node-tools"</span>,</div><div class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</div><div class="line">  <span class="string">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="string">"scripts"</span>: &#123;</div><div class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"author"</span>: <span class="string">""</span>,</div><div class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">* @Author: amos</div><div class="line">* @Date:   2016-04-08 13:57:37</div><div class="line">* @Last Modified by:   amos</div><div class="line">* @Last Modified time: 2016-04-08 13:58:26</div><div class="line">*/</div><div class="line"><span class="meta"></span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = <span class="built_in">require</span>(./lib/index);</div></pre></td></tr></table></figure>
</li>
<li><p><code>lib/index.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * @Author: amos</div><div class="line"> * @Date:   2016-04-08 13:58:47</div><div class="line"> * @Last Modified by:   amos</div><div class="line"> * @Last Modified time: 2016-04-08 14:19:04</div><div class="line"> */</div><div class="line"><span class="meta"></span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="keyword">var</span> Tools = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">//==================================</span></div><div class="line">	<span class="comment">// 检测iOS版本</span></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">gtIOS</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> userAgent = <span class="built_in">window</span>.navigator.userAgent;</div><div class="line">		<span class="keyword">var</span> ios = userAgent.match(<span class="regexp">/(iPad|iPhone|iPod)/</span>s + OS / s([<span class="regexp">/d_/</span>.] + ) / );</div><div class="line">		<span class="keyword">return</span> ios &amp;&amp; ios[<span class="number">2</span>] &amp;&amp; <span class="built_in">parseInt</span>(ios[<span class="number">2</span>].replace(<span class="regexp">/_/g</span>, <span class="string">'.'</span>), <span class="number">10</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//==================================</span></div><div class="line"></div><div class="line">	<span class="comment">//==================================</span></div><div class="line">	<span class="comment">// 检测支持css属性</span></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">isSupportCss</span>(<span class="params">key, value</span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> prefixTestList = [<span class="string">''</span>, <span class="string">'-webkit-'</span>, <span class="string">'-ms-'</span>, <span class="string">'-moz-'</span>, <span class="string">'-o-'</span>];</div><div class="line">		<span class="keyword">var</span> cssText = <span class="string">''</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; prefixTestList.length; i++) &#123;</div><div class="line">			cssText += key + <span class="string">':'</span> + prefixTestList[i] + value + <span class="string">';'</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// 创建一个dom来检查</span></div><div class="line">		<span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">		<span class="keyword">var</span> body = <span class="built_in">document</span>.body;</div><div class="line">		div.style.cssText = <span class="string">'display:none;'</span> + cssText;</div><div class="line">		body.appendChild(div);</div><div class="line">		<span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(value, i);</div><div class="line">		<span class="keyword">var</span> isSupport = reg.test(<span class="built_in">window</span>.getComputedStyle(div)[key]);</div><div class="line">		body.removeChild(div);</div><div class="line">		div = <span class="literal">null</span>;</div><div class="line">		<span class="keyword">return</span> isSupport;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//==================================</span></div><div class="line"></div><div class="line">	<span class="comment">//==================================</span></div><div class="line">	<span class="comment">// 防止内容区域滚到底后引起页面整体的滚动</span></div><div class="line">	<span class="keyword">var</span> content = <span class="built_in">document</span>.querySelector(<span class="string">'main'</span>);</div><div class="line">	<span class="keyword">var</span> startY;</div><div class="line"></div><div class="line">	content.addEventListener(<span class="string">'touchstart'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">		startY = e.touches[<span class="number">0</span>].clientY;</div><div class="line">	&#125;);</div><div class="line"></div><div class="line">	content.addEventListener(<span class="string">'touchmove'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">		<span class="comment">// 高位表示向上滚动</span></div><div class="line">		<span class="comment">// 底位表示向下滚动</span></div><div class="line">		<span class="comment">// 1容许 0禁止</span></div><div class="line">		<span class="keyword">var</span> status = <span class="string">'11'</span>;</div><div class="line">		<span class="keyword">var</span> ele = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">		<span class="keyword">var</span> currentY = e.touches[<span class="number">0</span>].clientY;</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (ele.scrollTop === <span class="number">0</span>) &#123;</div><div class="line">			<span class="comment">// 如果内容小于容器则同时禁止上下滚动</span></div><div class="line">			status = ele.offsetHeight &gt;= ele.scrollHeight ? <span class="string">'00'</span> : <span class="string">'01'</span>;</div><div class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ele.scrollTop + ele.offsetHeight &gt;= ele.scrollHeight) &#123;</div><div class="line">			<span class="comment">// 已经滚到底部了只能向上滚动</span></div><div class="line">			status = <span class="string">'10'</span>;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (status != <span class="string">'11'</span>) &#123;</div><div class="line">			<span class="comment">// 判断当前的滚动方向</span></div><div class="line">			<span class="keyword">var</span> direction = currentY - startY &gt; <span class="number">0</span> ? <span class="string">'10'</span> : <span class="string">'01'</span>;</div><div class="line">			<span class="comment">// 操作方向和当前允许状态求与运算，运算结果为0，就说明不允许该方向滚动，则禁止默认事件，阻止滚动</span></div><div class="line">			<span class="keyword">if</span> (!(<span class="built_in">parseInt</span>(status, <span class="number">2</span>) &amp; <span class="built_in">parseInt</span>(direction, <span class="number">2</span>))) &#123;</div><div class="line">				stopEvent(e);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">	<span class="comment">//==================================</span></div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="attr">gtIOS</span>: gtIOS,</div><div class="line">		<span class="attr">isSupportCss</span>: isSupportCss</div><div class="line">	&#125;;</div><div class="line">&#125;());</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = Tools;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="发布应用">发布应用</h4><pre><code><span class="bullet">* </span>npm发布
<span class="bullet">* </span>通过require的方式引用，直接使用
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<h4 id="环境要求">环境要求</h4><ul>
<li>nodejs</li>
</ul>
<h4 id="基本文件结构">基本文件结构</h4><ul>
<li>package.json <ul>
<li>使用npm init生成</li>
<li>安装依赖模块使用 npm install 模块名</li>
</ul>
</li>
<li>一个主文件 index.js</li>
<li>一个lib文件夹<ul>
<li>存放源文件]]>
    
    </summary>
    
      <category term="nodejs" scheme="http://www.xuerlove.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[移动端布局]]></title>
    <link href="http://www.xuerlove.com/2016/04/14/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B8%83%E5%B1%80/"/>
    <id>http://www.xuerlove.com/2016/04/14/移动端布局/</id>
    <published>2016-04-14T02:39:45.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<ol>
<li><p>黏性布局 POSITION:STICKY（通过判断支持该属性的浏览器使用该布局） – <a href="http://hao.jser.com/archive/7970/" target="_blank" rel="external">http://hao.jser.com/archive/7970/</a></p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.sticky &#123;</div><div class="line">    <span class="attr">position</span>: -webkit-sticky;</div><div class="line">    position: sticky;</div><div class="line">    top: <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line">.fixed &#123;</div><div class="line">    <span class="attr">position</span>: fixed;</div><div class="line">    top: <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Web移动端Fixed布局的解决方案  – <a href="http://efe.baidu.com/blog/mobile-fixed-layout/" target="_blank" rel="external">http://efe.baidu.com/blog/mobile-fixed-layout/</a></p>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<ol>
<li><p>黏性布局 POSITION:STICKY（通过判断支持该属性的浏览器使用该布局） – <a href="http://hao.jser.com/archive/7970/">http://hao.jser.com/archive/7970/</a></p>]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[动态脚本]]></title>
    <link href="http://www.xuerlove.com/2015/11/25/%E5%8A%A8%E6%80%81%E8%84%9A%E6%9C%AC/"/>
    <id>http://www.xuerlove.com/2015/11/25/动态脚本/</id>
    <published>2015-11-25T07:03:01.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="动态加载js">动态加载js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadScript</span>(<span class="params">data,type</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">"script"</span>);</div><div class="line">	script.type = <span class="string">"text/javascript"</span>;</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">		<span class="keyword">if</span>(type === <span class="number">1</span>)&#123;</div><div class="line">			script.appendChild(<span class="built_in">document</span>.createTextNode(data));</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			script.src = data;</div><div class="line">		&#125;</div><div class="line">	&#125;<span class="keyword">catch</span>(ex)&#123;</div><div class="line">		<span class="keyword">if</span>(type === <span class="number">1</span>)&#123;</div><div class="line">			script.text = code</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			script.src = data;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">document</span>.body.appendChild(script);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="动态样式">动态样式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadStyle</span>(<span class="params">data,type</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> style = <span class="built_in">document</span>.createElement(<span class="string">"style"</span>);</div><div class="line">	style.type = <span class="string">"text/css"</span>;</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">		<span class="keyword">if</span>(type === <span class="number">1</span>)&#123;</div><div class="line">			style.appendChild(<span class="built_in">document</span>.createTextNode(data));</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			style.href = data;</div><div class="line">		&#125;</div><div class="line">	&#125;<span class="keyword">catch</span>(ex)&#123;</div><div class="line">		<span class="keyword">if</span>(type === <span class="number">1</span>)&#123;</div><div class="line">			style.styleSheet.cssText = css;</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			style.href = data;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">var</span> head = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>];</div><div class="line">	head.appendChild(style);</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h4 id="动态加载js">动态加载js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadScript</span>(<span class="params">data,type</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">"script"</span>);</div><div class="line">	script.type = <span class="string">"text/javascript"</span>;</div><div class="line">	<span class="keyword">try</span>&#123;</div><div class="line">		<span class="keyword">if</span>(type === <span class="number">1</span>)&#123;</div><div class="line">			script.appendChild(<span class="built_in">document</span>.createTextNode(data));</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			script.src = data;</div><div class="line">		&#125;</div><div class="line">	&#125;<span class="keyword">catch</span>(ex)&#123;</div><div class="line">		<span class="keyword">if</span>(type === <span class="number">1</span>)&#123;</div><div class="line">			script.text = code</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			script.src = data;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">document</span>.body.appendChild(script);</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://www.xuerlove.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[DOM操作]]></title>
    <link href="http://www.xuerlove.com/2015/11/24/DOM%E6%93%8D%E4%BD%9C/"/>
    <id>http://www.xuerlove.com/2015/11/24/DOM操作/</id>
    <published>2015-11-24T07:03:01.000Z</published>
    <updated>2017-02-17T06:18:27.000Z</updated>
    <content type="html"><![CDATA[<h4 id="Node">Node</h4><h5 id="操作节点">操作节点</h5><ul>
<li>appendChild()<br>一个参数，要插入的节点</li>
<li>insertBefore()<br>两个参数，要插入的节点和参照的节点</li>
<li>replaceChild()<br>两个参数，要插入的节点和要替换的节点</li>
<li>removeChild()<br>一个参数，要移除的节点</li>
<li>cloneNode()<br>一个参数，布尔值，是否执行深度克隆</li>
<li>normalize()<br>合并文本节点<a id="more"></a>
</li>
</ul>
<h4 id="Document">Document</h4><h5 id="document-getElementById">document.getElementById</h5><ul>
<li>IE7及以前的版本忽略大小写，除此之外必须严格按照大小写</li>
<li>如果不传参数返回null</li>
<li>IE7及以前的版本如果表单元素name属性和某元素id相等，会返回表单元素</li>
</ul>
<h5 id="document-getElementsByTagName">document.getElementsByTagName</h5><ul>
<li>返回标签元素的集合</li>
</ul>
<h5 id="namedItem_返回标签集合中指定name元素">namedItem 返回标签集合中指定name元素</h5><ul>
<li>使用中括号的方式能达到namedItem效果</li>
<li>获取所有html元素，传入<code>*</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> images = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'image'</span>);</div><div class="line"><span class="keyword">var</span> logo = images.namedItem(<span class="string">'logo'</span>);</div><div class="line"><span class="keyword">var</span> author = images[<span class="string">'author'</span>];</div><div class="line"><span class="built_in">document</span>.getElementsByName</div></pre></td></tr></table></figure>
</li>
</ul>
<p>与 document.getElementsByTagName 类似</p>
<h5 id="特殊方法">特殊方法</h5><ul>
<li>document.anchors返回所有带name的a元素</li>
<li>document.forms返回所有form元素</li>
<li>document.images返回所有img元素</li>
<li>document.links返回所有带href的元素</li>
</ul>
<h5 id="元素属性">元素属性</h5><ul>
<li>id 元素唯一标示</li>
<li>title 附加说明</li>
<li>className 元素css类</li>
<li>lang 元素内容语言代码</li>
<li>dir 语言方向</li>
</ul>
<h5 id="元素方法">元素方法</h5><ul>
<li>getAttribute<br>不能获取style属性，以及类似onclick这样的事件处理属性</li>
<li>setAttribute<br>设置属性值，接收两个参数，第一个是属性名，第二个是属性值</li>
<li>removeAttribute<br>彻底删除属性</li>
<li>attributes属性<br>Element类型拥有attributes属性</li>
</ul>
<h5 id="方法">方法</h5><ul>
<li><p>getNamedItem(name) 返回指定属性值 (可以使用方括号访问方式)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> id = elements.attributes.getNamedItem(<span class="string">'id'</span>).nodeValue;</div><div class="line"><span class="keyword">var</span> id = elements.attributes[<span class="string">'id'</span>].nodeValue;</div></pre></td></tr></table></figure>
</li>
<li><p>removeNamedItem(name) 移除指定属性</p>
</li>
<li>setNamedItem(node) 添加属性</li>
<li><p>item(pos) 返回位于pos位置的节点</p>
</li>
<li><p>遍历所有属性的时候可以使用这些方法</p>
</li>
<li>attributes属性,不同浏览器返回顺序不一致</li>
<li>IE7及以前的版本会返回所有可能的属性，为避免这个，需要使用specified检测，未设置过的特性为false</li>
</ul>
<h5 id="创建元素">创建元素</h5><ul>
<li><p>document.createElement()<br>接收一个参数，创建的标签</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">div.id=<span class="string">"top"</span>;</div><div class="line">div.className = <span class="string">"m-top"</span>;</div></pre></td></tr></table></figure>
<ul>
<li>IE中支持参数传入完整的标签内容，有助于避免IE7以及以前版本的一些bug</li>
<li>不能动态设置iframe name属性</li>
<li>创建name相同的radio，互无联系</li>
<li>但是，这样方式又只有IE才支持，所以，使用时需要做检测执行</li>
</ul>
</li>
</ul>
<h5 id="Text文本节点">Text文本节点</h5><p>创建文本节点document.createTextNode()<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ele = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line"><span class="keyword">var</span> txt = <span class="built_in">document</span>.createTextNode(<span class="string">'hello'</span>);</div><div class="line">ele.appendChild(txt);</div><div class="line"><span class="built_in">document</span>.body.appendChild(ele);</div></pre></td></tr></table></figure></p>
<h5 id="规范化文本节点">规范化文本节点</h5><ul>
<li>使用normalize()方法合并文本节点</li>
</ul>
<h5 id="分割文本节点">分割文本节点</h5><ul>
<li>splitText(pos)方法，pos是指定位置</li>
</ul>
<h5 id="其它方法">其它方法</h5><ul>
<li>appendData(text)</li>
<li>deleteData(offset,count)</li>
<li>insertData(offset,text)</li>
<li>replaceData(offset,count,text)</li>
<li>substringData(offset,data)</li>
</ul>
<h5 id="DocumentFragment">DocumentFragment</h5><ul>
<li>文档片段，创建方法<br>  document.createDocumentFragment()</li>
<li>操作复杂dom的时候，可以使用片段操作，这样会避免页面多次页面重新渲染</li>
</ul>
<h5 id="Attr属性">Attr属性</h5><ul>
<li>创建属性<br>document.createAttribute()<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> attr = <span class="built_in">document</span>.createAttribute(<span class="string">'align'</span>);</div><div class="line">attr.value = <span class="string">'left'</span>;</div><div class="line">ele.setAttribute(attr);</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="selector_API">selector API</h5><ol>
<li>querySelector()<ul>
<li>接收css选择符，返回匹配到的第一个元素</li>
<li>document.querySelector()</li>
<li>document.body.querySelector()</li>
</ul>
</li>
<li>querySelectorAll()<ul>
<li>返回NodeList,使用与querySelector()相同</li>
</ul>
</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="Node">Node</h4><h5 id="操作节点">操作节点</h5><ul>
<li>appendChild()<br>一个参数，要插入的节点</li>
<li>insertBefore()<br>两个参数，要插入的节点和参照的节点</li>
<li>replaceChild()<br>两个参数，要插入的节点和要替换的节点</li>
<li>removeChild()<br>一个参数，要移除的节点</li>
<li>cloneNode()<br>一个参数，布尔值，是否执行深度克隆</li>
<li>normalize()<br>合并文本节点]]>
    
    </summary>
    
      <category term="javascript" scheme="http://www.xuerlove.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[shell基础]]></title>
    <link href="http://www.xuerlove.com/2015/11/23/shell%E5%9F%BA%E7%A1%80/"/>
    <id>http://www.xuerlove.com/2015/11/23/shell基础/</id>
    <published>2015-11-23T07:03:01.000Z</published>
    <updated>2017-02-17T06:25:04.000Z</updated>
    <content type="html"><![CDATA[<h4 id="shell分类">shell分类</h4><ul>
<li>Bourne Shell（/usr/bin/sh或/bin/sh）</li>
<li>Bourne Again Shell（/bin/bash）</li>
<li>C Shell（/usr/bin/csh）</li>
<li>K Shell（/usr/bin/ksh）</li>
<li>Shell for Root（/sbin/sh）</li>
<li>eg.<a id="more"></a>
</li>
</ul>
<h5 id="#!"><code>#!</code></h5><p><code>#!</code>告诉系统其后路径所指定的程序即是解释此脚本文件的Shell程序。</p>
<ul>
<li>执行<ul>
<li><code>./test.sh</code>使用想对路径</li>
<li>sh test.sh</li>
</ul>
</li>
<li><p>变量</p>
<ul>
<li>直接使用变量名 <code>test=&quot;123&quot;</code></li>
</ul>
</li>
<li><p>变量名和等号之间不能有空格</p>
</li>
<li>首个字符必须为字母（a-z，A-Z）。</li>
<li>中间不能有空格，可以使用下划线（_）。</li>
<li>不能使用标点符号。</li>
<li>不能使用bash里的关键字（可用help命令查看保留关键字）。</li>
</ul>
<h5 id="使用语句给变量赋值">使用语句给变量赋值</h5><ul>
<li>for file inls /etc``</li>
</ul>
<h5 id="使用变量">使用变量</h5><p>在变量名前添加美元符号 <code>$</code><br><code>$test</code>或者<code>${test}</code></p>
<h5 id="字符串">字符串</h5><ul>
<li>单引号<ul>
<li>不能使用变量</li>
<li>不能出现单引号，不能使用转译字符</li>
</ul>
</li>
<li>双引号<ul>
<li>可以使用变量</li>
<li>可以使用转译字符</li>
</ul>
</li>
</ul>
<h5 id="拼接字符串">拼接字符串</h5><ul>
<li>不需要使用 <code>+</code> 符号<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">name=<span class="string">"zhuo"</span></div><div class="line">say=<span class="string">"hi "</span>$name<span class="string">" !"</span></div><div class="line">says = <span class="string">"hi $&#123;name&#125; !"</span></div><div class="line">echo say says</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="字符串长度">字符串长度</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">string="tetetete"</div><div class="line">echo $&#123;#string&#125;</div></pre></td></tr></table></figure>
<h5 id="截取字符串">截取字符串</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">string=<span class="string">"tetetete"</span></div><div class="line">echo $&#123;<span class="attr">string</span>:<span class="number">2</span>:<span class="number">4</span>&#125;</div></pre></td></tr></table></figure>
<h5 id="查找字符串">查找字符串</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">string=<span class="string">"asdfsdf werfvsd"</span></div><div class="line">echo <span class="string">`expr index "$string" is`</span></div></pre></td></tr></table></figure>
<h5 id="数组">数组</h5><p>创建数组以及访问数组<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">arr=(1,2,3,4,5)</div><div class="line">#或者</div><div class="line">arr[0]=1</div><div class="line">arr[1]=2</div><div class="line">arr[2]=3</div><div class="line">#访问</div><div class="line">echo $&#123;arr[0]&#125;</div><div class="line">#访问所有元素</div><div class="line">echo $&#123;arr[@]&#125;</div></pre></td></tr></table></figure></p>
<h5 id="数组长度">数组长度</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">len=$&#123;#arr[@]&#125;</div></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">len=$&#123;$arr[*]&#125;</div></pre></td></tr></table></figure></p>
<p>数组单个元素长度<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">len=$&#123;$arr[n]&#125;</div></pre></td></tr></table></figure></p>
<h5 id="注释">注释</h5><ul>
<li>不支持多行注释，单行注释使用#</li>
<li>开发过程中，为方便注释，可以把需要注释的代码放在一个函数中<h5 id="echo">echo</h5>输出字符串<br>echo string<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">echo &quot;test&quot;</div><div class="line">echo test</div><div class="line">echo &quot;\&quot;test\&quot;&quot;</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="read">read</h5><p>输入字符<br>read name<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/sh</span></div><div class="line">read name</div><div class="line">echo <span class="string">"$&#123;name&#125;"</span></div></pre></td></tr></table></figure></p>
<h5 id="显示">显示</h5><p><code>-e</code>开启转义<br>换行<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo -e "test!\n" # \n换行</div><div class="line">echo "ok"</div></pre></td></tr></table></figure></p>
<h5 id="不换行">不换行</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo -e "test!\c" # \c不换行</div><div class="line">echo "ok"</div></pre></td></tr></table></figure>
<h5 id="输出到文件">输出到文件</h5><p><code>echo &quot;test&quot; &gt; test.txt</code></p>
<h5 id="原格式输出">原格式输出</h5><p>使用单引号，不进行转义</p>
<h5 id="显示执行结果">显示执行结果</h5><p><code>echo</code>data``</p>
<h5 id="test命令">test命令</h5><p>检测某个条件是否成立</p>
<pre><code>* 数值测试
<span class="comment"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-eq	等于则为真</div><div class="line">-ne	不等于则为真</div><div class="line">-gt	大于则为真</div><div class="line">-ge	大于等于则为真</div><div class="line">-lt	小于则为真</div><div class="line">-le	小于等于则为真</div></pre></td></tr></table></figure></span>

<span class="comment"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">x=read</div><div class="line">y=read</div><div class="line"><span class="keyword">if</span> test $[x] -eq $[y]</div><div class="line">then</div><div class="line">	echo <span class="string">"ok"</span></div><div class="line">elif test $x -gt $y</div><div class="line">	echo <span class="string">"gt"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">	echo <span class="string">"bad"</span></div><div class="line">fi</div></pre></td></tr></table></figure></span>

* 字符串测试
<span class="comment"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">=	等于则为真</div><div class="line">!=	不相等则为真</div><div class="line">-z 字符串	字符串长度伪则为真</div><div class="line">-n 字符串	字符串长度不伪则为真</div></pre></td></tr></table></figure></span>

<span class="comment"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">x=read</div><div class="line">y=read</div><div class="line"><span class="keyword">if</span> test $x -eq $y</div><div class="line">then</div><div class="line">	echo <span class="string">"ok"</span></div><div class="line">elif test $x -gt $y</div><div class="line">	echo <span class="string">"gt"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">	echo <span class="string">"bad"</span></div><div class="line">fi</div></pre></td></tr></table></figure></span>
</code></pre><h5 id="文件测试">文件测试</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">-e 文件名	如果文件存在则为真</div><div class="line">-r 文件名	如果文件存在且可读则为真</div><div class="line">-w 文件名	如果文件存在且可写则为真</div><div class="line">-x 文件名	如果文件存在且可执行则为真</div><div class="line">-s 文件名	如果文件存在且至少有一个字符则为真</div><div class="line">-d 文件名	如果文件存在且为目录则为真</div><div class="line">-f 文件名	如果文件存在且为普通文件则为真</div><div class="line">-c 文件名	如果文件存在且为字符型特殊文件则为真</div><div class="line">-b 文件名	如果文件存在且为块特殊文件则为真</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> test -e ./blog</div><div class="line">then </div><div class="line">	echo <span class="string">'file exists'</span></div><div class="line"><span class="keyword">else</span></div><div class="line">	echo <span class="string">'file does not exists'</span></div><div class="line">fi</div><div class="line"><span class="string">``</span><span class="string">`javascript</span></div><div class="line">`Shell还提供了 与( -a )、或( -o )、非( ! ) 三个逻辑操作符用于将测试条件连接起来，优先级：”!” “-a” “-o”<span class="string">`</span></div><div class="line">##### 流程控制</div><div class="line">* if else</div><div class="line">`<span class="string">``</span>javascript</div><div class="line">x=read</div><div class="line">y=read</div><div class="line"><span class="keyword">if</span> test $x -eq $y</div><div class="line">then</div><div class="line">	echo <span class="string">"ok"</span></div><div class="line">elif test $x -gt $y</div><div class="line">	echo <span class="string">"gt"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">	echo <span class="string">"bad"</span></div><div class="line">fi</div></pre></td></tr></table></figure>
<h5 id="for">for</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> it <span class="keyword">in</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span></div><div class="line"><span class="keyword">do</span></div><div class="line">	echo $it</div><div class="line">done</div></pre></td></tr></table></figure>
<h5 id="while">while</h5><p>条件为真则执行<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">count=<span class="number">1</span></div><div class="line"><span class="keyword">while</span>(($count&lt;<span class="number">10</span>))</div><div class="line"><span class="keyword">do</span></div><div class="line">	echo $count</div><div class="line">	<span class="keyword">let</span> <span class="string">"count++"</span></div><div class="line">done</div></pre></td></tr></table></figure></p>
<h5 id="until">until</h5><p>直到条件为真停止,用法与while相同<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">count=<span class="number">100</span></div><div class="line">until(($count&lt;=<span class="number">10</span>))</div><div class="line"><span class="keyword">do</span></div><div class="line">	echo $count</div><div class="line">	<span class="keyword">let</span> <span class="string">"count--"</span></div><div class="line">done</div></pre></td></tr></table></figure></p>
<h5 id="case">case</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">echo <span class="string">'请输入1-3的数字:'</span></div><div class="line">read num</div><div class="line"><span class="keyword">case</span> $num <span class="keyword">in</span></div><div class="line">	<span class="number">1</span>) echo <span class="string">'你输入了1'</span></div><div class="line">	;;</div><div class="line">	<span class="number">2</span>) echo <span class="string">'你输入了2'</span></div><div class="line">	;;</div><div class="line">	<span class="number">3</span>) echo <span class="string">'你输入了3'</span></div><div class="line">	;;</div><div class="line">	*) echo <span class="string">'你没有输入1到3的数字'</span></div><div class="line">	;;</div><div class="line">esac</div></pre></td></tr></table></figure>
<h5 id="break">break</h5><p>跳出所有循环</p>
<h5 id="continue">continue</h5><p>结束当前循环，继续执行下一次循环</p>
<h5 id="函数">函数</h5><ul>
<li>定义方式,不需要带参数</li>
<li>function fun()</li>
<li>fun()<ul>
<li>参数返回，使用return</li>
<li>函数调用，直接使用函数名，不需要加括号，带有参数直接在后面列出，用空格间隔</li>
<li>函数返回值在调用函数后，可以通过$?使用</li>
<li>函数中的参数，可以使用$n来表示，n&gt;10的时候，使用${n}</li>
<li>特殊参数<ul>
<li><code>$#</code> 传递到脚本的参数个数</li>
<li><code>$*</code> 以一个单字符串显示所有向脚本传递的参数</li>
<li><code>$$</code> 脚本运行的当前进程ID号</li>
<li><code>$!</code> 后台运行的最后一个进程的ID号</li>
<li><code>$@</code> 与$*相同，但是使用时加引号，并在引号中返回每个参数。</li>
<li><code>$-</code> 显示Shell使用的当前选项，与set命令功能相同。</li>
<li><code>$?</code> 显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。</li>
</ul>
</li>
</ul>
</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="shell分类">shell分类</h4><ul>
<li>Bourne Shell（/usr/bin/sh或/bin/sh）</li>
<li>Bourne Again Shell（/bin/bash）</li>
<li>C Shell（/usr/bin/csh）</li>
<li>K Shell（/usr/bin/ksh）</li>
<li>Shell for Root（/sbin/sh）</li>
<li>eg.]]>
    
    </summary>
    
      <category term="linux" scheme="http://www.xuerlove.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用nproxy实现本地代理]]></title>
    <link href="http://www.xuerlove.com/2015/11/22/%E4%BD%BF%E7%94%A8nproxy%E5%AE%9E%E7%8E%B0%E6%9C%AC%E5%9C%B0%E4%BB%A3%E7%90%86/"/>
    <id>http://www.xuerlove.com/2015/11/22/使用nproxy实现本地代理/</id>
    <published>2015-11-22T07:03:01.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="安装">安装</h4><h5 id="先安装Node-js">先安装Node.js</h5><h5 id="安装nproxy">安装nproxy</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo npm install -g nproxy</div></pre></td></tr></table></figure>
<h5 id="nproxy介绍">nproxy介绍</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Options:</div><div class="line">    -h, --help               output usage information</div><div class="line">    -V, --version            output the version number</div><div class="line">    -l, --list [list]        Specify the replace rule file</div><div class="line">    -p, --port [port]        Specify the port</div><div class="line">    -t, --timeout [timeout]  Specify the request timeout(<span class="number">5</span> seconds by <span class="keyword">default</span>)</div><div class="line">    -d, --debug              Enable debug mode</div><div class="line">    -n, --networks           Display network interface list</div></pre></td></tr></table></figure>
<a id="more"></a>
<h5 id="开启代理端口">开启代理端口</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nproxy -l replace_rule.js -p <span class="number">8188</span></div></pre></td></tr></table></figure>
<p>使用本地replace_rule.js转换规则，监听本地8188端口</p>
<h5 id="replace_rule-js">replace_rule.js</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = [</div><div class="line">    &#123;</div><div class="line">        <span class="attr">pattern</span>:<span class="string">'http://test.test.com/pro/(.*)'</span>,</div><div class="line">        <span class="attr">responder</span>:<span class="string">"http://127.0.0.1/pro/$1"</span></div><div class="line">    &#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<h5 id="浏览器怎么做">浏览器怎么做</h5><ul>
<li>安装代理插件，一大堆</li>
<li>配置代理 127.0.0.1 端口8188</li>
<li>可以设置自动转换规则，即：哪些网站使用这个代理</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="安装">安装</h4><h5 id="先安装Node-js">先安装Node.js</h5><h5 id="安装nproxy">安装nproxy</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo npm install -g nproxy</div></pre></td></tr></table></figure>
<h5 id="nproxy介绍">nproxy介绍</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Options:</div><div class="line">    -h, --help               output usage information</div><div class="line">    -V, --version            output the version number</div><div class="line">    -l, --list [list]        Specify the replace rule file</div><div class="line">    -p, --port [port]        Specify the port</div><div class="line">    -t, --timeout [timeout]  Specify the request timeout(<span class="number">5</span> seconds by <span class="keyword">default</span>)</div><div class="line">    -d, --debug              Enable debug mode</div><div class="line">    -n, --networks           Display network interface list</div></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[nginx配置https]]></title>
    <link href="http://www.xuerlove.com/2015/11/21/nginx%E9%85%8D%E7%BD%AEhttps/"/>
    <id>http://www.xuerlove.com/2015/11/21/nginx配置https/</id>
    <published>2015-11-21T07:03:01.000Z</published>
    <updated>2017-02-17T03:13:09.000Z</updated>
    <content type="html"><![CDATA[<h4 id="安装">安装</h4><h5 id="系统：centos">系统：centos</h5><ul>
<li>wget下载</li>
<li>tar 解压</li>
<li>sudo ./configure —with-http_rewrite_module —with-pcre=../pcre-8.36 —with-* http_stub_status_module —with-http_ssl_module —with-http_realip_module 安装这些模块，如果安装失败，请wget下载缺失的包，解压安装后，再重新执行，等号后面添加模块路径</li>
<li>sudo make</li>
<li>sudo make install<a id="more"></a>
</li>
</ul>
<h5 id="配置转发">配置转发</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">upstream  test&#123;</div><div class="line">     server **.**.**.**:****;</div><div class="line">&#125;</div><div class="line"></div><div class="line">server &#123;</div><div class="line">        listen **.**.**.**:<span class="number">8888</span>;</div><div class="line">        server_name test.test.com;</div><div class="line">        charset utf8;</div><div class="line">        gzip                    off;</div><div class="line">        gzip_http_version       <span class="number">1.1</span>;</div><div class="line">        gzip_buffers            <span class="number">256</span> <span class="number">64</span>k;</div><div class="line">        gzip_comp_level         <span class="number">5</span>;</div><div class="line">        gzip_min_length         <span class="number">1000</span>;</div><div class="line">        gzip_types              application/x-javascript text/javascript text/plain text/xml text/css image/jpeg image/jpg image/png image/gif application/x-shockwave-flash image/x-icon;</div><div class="line"></div><div class="line">    </div><div class="line">         proxy_set_header  Host  $host;</div><div class="line">         proxy_set_header  X-Real-IP  $remote_addr;</div><div class="line">         proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class="line"></div><div class="line"></div><div class="line">        location ~ <span class="regexp">/test/</span> &#123;</div><div class="line">                proxy_pass http:<span class="comment">//test;</span></div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="支持https">支持https</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">upstream  test&#123;</div><div class="line">     server **.**.**.**:****;</div><div class="line">&#125;</div><div class="line"></div><div class="line">server &#123;</div><div class="line">        listen **.**.**.**:<span class="number">443</span> ssl;</div><div class="line">        server_name test.test.com;</div><div class="line">        charset utf8;</div><div class="line">        gzip                    off;</div><div class="line">        gzip_http_version       <span class="number">1.1</span>;</div><div class="line">        gzip_buffers            <span class="number">256</span> <span class="number">64</span>k;</div><div class="line">        gzip_comp_level         <span class="number">5</span>;</div><div class="line">        gzip_min_length         <span class="number">1000</span>;</div><div class="line">        gzip_types              application/x-javascript text/javascript text/plain text/xml text/css image/jpeg image/jpg image/png image/gif application/x-shockwave-flash image/x-icon;</div><div class="line"></div><div class="line">        ssl on;</div><div class="line">        ssl_certificate             /home/q/nginx/conf/server.crt;</div><div class="line">        ssl_certificate_key         /home/q/nginx/conf/server.key;</div><div class="line">        ssl_session_timeout         <span class="number">5</span>m;</div><div class="line">        ssl_protocols               SSLv3 TLSv1;</div><div class="line">        ssl_ciphers                 ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;</div><div class="line">        ssl_prefer_server_ciphers   on;</div><div class="line"></div><div class="line">         proxy_set_header  Host  $host;</div><div class="line">         proxy_set_header  X-Real-IP  $remote_addr;</div><div class="line">         proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;</div><div class="line"></div><div class="line"></div><div class="line">        location ~ <span class="regexp">/test/</span> &#123;</div><div class="line">                proxy_pass http:<span class="comment">//test;</span></div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="证书">证书</h5><ul>
<li><p>两种方式</p>
<ul>
<li><p>生成证书</p>
  <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#cd /home/q/nginx/conf</div><div class="line">#openssl genrsa -des3 -out server.key 1024</div><div class="line">#openssl req -new -key server.key -out server.csr</div><div class="line">#openssl rsa -in server.key -out server_nopwd.key</div><div class="line">#openssl x509 -req -days 365 -in server.csr -signkey server_nopwd.key -out server.crt</div></pre></td></tr></table></figure>
<p>  中途需要输入密码，自己设定即可</p>
</li>
<li>copy<br>  直接copy别的机器上面已经存在的证书</li>
</ul>
</li>
</ul>
<h5 id="浏览器">浏览器</h5><ul>
<li>方法一：如果提示安全提示，点击高级》继续浏览</li>
<li>方法二：把生成的server.crt文件导入到系统的证书管理器就行了，具体方法：不介绍了</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="安装">安装</h4><h5 id="系统：centos">系统：centos</h5><ul>
<li>wget下载</li>
<li>tar 解压</li>
<li>sudo ./configure —with-http_rewrite_module —with-pcre=../pcre-8.36 —with-* http_stub_status_module —with-http_ssl_module —with-http_realip_module 安装这些模块，如果安装失败，请wget下载缺失的包，解压安装后，再重新执行，等号后面添加模块路径</li>
<li>sudo make</li>
<li>sudo make install]]>
    
    </summary>
    
      <category term="web" scheme="http://www.xuerlove.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[javascript面向对象相关]]></title>
    <link href="http://www.xuerlove.com/2015/11/21/javascript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9B%B8%E5%85%B3/"/>
    <id>http://www.xuerlove.com/2015/11/21/javascript面向对象相关/</id>
    <published>2015-11-21T07:03:01.000Z</published>
    <updated>2017-02-17T06:22:12.000Z</updated>
    <content type="html"><![CDATA[<h4 id="判断属性属于实力对象还是原型">判断属性属于实力对象还是原型</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">name,obj</span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> !(obj.hasOwnProperty) &amp;&amp; (name <span class="keyword">in</span> obj)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="for_in循环">for in循环</h4><p>for in循环能够返回对象所有可枚举属性，无论实例中的，还是原型中的。即便是实例中重写了原型中不可枚举的属性，也会访问到。但是在IE8及以下存在bug,这样的属性不会被返回</p>
<p>####继承<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">	F.prototype = o;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> F();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritPrototype</span>(<span class="params">subType,superType</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> prototype = object(superType.prototype);</div><div class="line">	prototype.constructor = subType;</div><div class="line">	subType.prototype = prototype;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.name = name;</div><div class="line">	<span class="keyword">this</span>.color = [<span class="string">"red"</span>,<span class="string">"blue"</span>];</div><div class="line">&#125;</div><div class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	alert(<span class="keyword">this</span>.name);</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name,age</span>)</span>&#123;</div><div class="line">	SuperType.call(<span class="keyword">this</span>,name);</div><div class="line">	<span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div><div class="line">inheritPrototype(SubType,SuperType);</div><div class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	alert(<span class="keyword">this</span>.age);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>只调用了一次SuperType的构造函数，并且避免了在SubType.prototype上面创建不必要的属性，同时原型链还能保持不变。</p>
<h4 id="单例模式">单例模式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> singleton = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> private = <span class="number">0</span>;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">privateFunc</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="attr">public</span>:<span class="literal">true</span>,</div><div class="line">		<span class="attr">publicFunc</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			private++;</div><div class="line">			<span class="keyword">return</span> privateFunc();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;();</div></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h4 id="判断属性属于实力对象还是原型">判断属性属于实力对象还是原型</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">name,obj</span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> !(obj.hasOwnProperty) &amp;&amp; (name <span class="keyword">in</span> obj)</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="javascript" scheme="http://www.xuerlove.com/tags/javascript/"/>
    
  </entry>
  
</feed>
